{"version":3,"file":"jquire.min.js","sources":["utility.js","jquire.js"],"sourcesContent":["var __classPrivateFieldSet = (this && this.__classPrivateFieldSet) || function (receiver, state, value, kind, f) {\n    if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\n    return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\n};\nvar __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\n};\nvar _a, _JqAnimation_parameters, _JqAttribute_name, _JqAttribute_value;\n/**\n *\n * @param {string} rootPath\n * @returns {(relativePath: string) => string}\n */\nexport function pathSetter(rootPath) {\n    return function (relativePath) {\n        return rootPath.replace(/\\/\\s*$/, '') + '/' +\n            relativePath.replace(/^(?:\\s*\\.)?\\s*\\//, '');\n    };\n}\nexport function isPrimitive(test) {\n    return test !== Object(test);\n}\nconst isJqElement = (...xs) => xs.every(x => x instanceof JqElement);\nconst isJqAttribute = (...xs) => xs.every(x => x instanceof JqAttribute);\nconst isJqFragment = (...xs) => xs.every(x => x instanceof JqFragment);\nconst isJqText = (...xs) => xs.every(x => x instanceof JqText);\nconst CREATED = Symbol(\"created\");\nconst UPDATED = Symbol(\"updated\");\nconst DELETED = Symbol(\"deleted\");\nconst UNCHANGED = Symbol(\"unchanged\");\nconst getJqNodeConstructors = () => [JqElement, JqAttribute, JqCSSProperty, JqCSSRule, JqAnimation, JqEvent, JqReference, JqFragment, JqText];\nexport const throwError = (e) => { throw new Error(e); };\nexport const JqNodeReference = Symbol(\"JqNodeReference\");\n/**\n *\n * @param {Array<JqNode | Primitive>} nodes\n * @returns {{\n *\t\tchildNodes: Array<JqElement | JqFragment | JqText>,\n *\t\tattributes: JqAttribute[],\n *\t\tevents: JqEvent[], references: JqReference[],\n *\t\tanimations: JqAnimation[], inlineStyles: JqCSSProperty[],\n *\t\tblockStyles: JqCSSRule[], callbacks: JqCallback[]\n * }}\n */\nexport function getNodes(nodes) {\n    const childNodes = [];\n    const attributes = [];\n    const events = [];\n    const references = [];\n    const animations = [];\n    const callbacks = [];\n    const inlineStyles = [];\n    const blockStyles = [];\n    const childNodeClasses = [JqElement, JqFragment, JqText];\n    for (const [i, node] of nodes.entries()) {\n        if (childNodeClasses.some(childNodeClass => node instanceof childNodeClass)) {\n            const _node = node;\n            _node.nodePosition = i;\n            childNodes.push(_node);\n        }\n        else if (node instanceof JqAttribute) {\n            node.nodePosition = i;\n            attributes.push(node);\n        }\n        else if (node instanceof JqList && node.nodeClass === JqAttribute) {\n            node.nodes.forEach((attribute) => {\n                attribute.nodePosition = i;\n                attributes.push(attribute);\n            });\n        }\n        else if (node instanceof JqEvent) {\n            node.nodePosition = i;\n            events.push(node);\n        }\n        else if (node instanceof JqReference) {\n            const _node = node[JqNodeReference];\n            _node.nodePosition = i;\n            references.push(_node);\n        }\n        else if (node instanceof JqAnimation) {\n            node.nodePosition = i;\n            animations.push(node);\n        }\n        else if (node instanceof JqCSSProperty) {\n            node.nodePosition = i;\n            inlineStyles.push(node);\n        }\n        else if (node instanceof JqCSSRule) {\n            node.nodePosition = i;\n            blockStyles.push(node);\n        }\n        else if (Array.isArray(node)) {\n            const _node = convertToJqNode(node, null);\n            _node.nodePosition = i;\n            childNodes.push(_node);\n        }\n        else if (typeof node == \"function\") {\n            const _node = convertToJqNode(node, null);\n            _node.nodePosition = i;\n            callbacks.push(_node);\n        }\n        else if (isPrimitive(node)) {\n            const _node = convertToJqNode(node, null);\n            _node.nodePosition = i;\n            childNodes.push(_node);\n        }\n    }\n    return {\n        childNodes, attributes,\n        events, references,\n        animations, inlineStyles,\n        blockStyles, callbacks\n    };\n}\nexport function convertToJqNode(value, jqNode) {\n    const convertToJqText = (value) => {\n        const jqText = new JqText(value ?? '');\n        jqText.jqParent = jqNode;\n        return jqText;\n    };\n    const convertToJqCallback = (value) => {\n        const jqCallback = new JqCallback(value);\n        jqCallback.jqParent = jqNode;\n        return jqCallback;\n    };\n    const convertToJqFragment = (value) => {\n        const childNodes = value.map(x => convertToJqNode(x, null));\n        const jqFragment = new JqFragment(childNodes);\n        childNodes.forEach((childNode, i) => {\n            childNode.jqParent = jqFragment;\n            childNode.nodePosition = i;\n        });\n        jqFragment.jqParent = jqNode;\n        return jqFragment;\n    };\n    if (Array.isArray(value))\n        return convertToJqFragment(value);\n    if (isPrimitive(value))\n        return convertToJqText(value);\n    if (typeof value == \"function\")\n        return convertToJqCallback(value);\n    if (getJqNodeConstructors().some(ctor => value instanceof ctor))\n        return value;\n    return throwError(`JqError - Unexpected value found in place of a JqNode`);\n}\nconst getPropertyValue = (object, props) => {\n    let result = object;\n    for (let i = 0; i < props.length; i++) {\n        result = result?.[props[i]];\n        if (isNullish(result))\n            return result;\n    }\n    return result;\n};\n/**\n * @param {string} text\n * @returns {string}\n */\nexport function escapeHTMLEntities(text) {\n    const entityRegex1 = /(&#x[0-9A-F]{2,6};)/gi;\n    const entityRegex2 = /(&[a-z0-9]+;)/gi;\n    const replacer = (t, e) => new DOMParser().parseFromString(e, \"text/html\").documentElement.textContent ?? '';\n    const _text = text.replace(entityRegex1, replacer)\n        .replace(entityRegex2, replacer);\n    return _text;\n}\nexport function stringify(value) {\n    return isPrimitive(value) ? String(value ?? '') : JSON.stringify(value);\n}\nexport function isNullish(value) {\n    return value === null || value === undefined;\n}\nexport class JqCallback {\n    constructor(callback) {\n        this.nodePosition = -1;\n        this.jqParent = null;\n        this.returned = null;\n        this.callback = (_) => null;\n        this.refProxy = new Proxy({ context: this }, {\n            get(target, prop) {\n                return target.context.jqParent?.getStateRefValue(prop);\n            },\n            set(target, prop, value) {\n                target.context.jqParent?.setStateRefValue(prop, value);\n                return true;\n            }\n        });\n        this.update = {\n            context: this,\n            updateCallback() {\n                const jqCallback = this.context;\n                if (jqCallback.returned === null)\n                    return this;\n                const oldNode = jqCallback.returned;\n                const newNode = jqCallback.invoke();\n                const rootNode = oldNode, parentNode = oldNode;\n                reconcile(rootNode, parentNode, oldNode, newNode);\n                return this;\n                function reconcile(rootNode, parentNode, oldNode, newNode) {\n                    const _diff = diff(oldNode, newNode);\n                    const node1 = _diff.node1;\n                    const node2 = _diff.node2;\n                    const updatedChanges = _diff[UPDATED];\n                    const createdChanges = _diff[CREATED];\n                    const deletedChanges = _diff[DELETED];\n                    for (const [firstProp, ...nestedProps] of updatedChanges) {\n                        if (isJqText(node1, node2)) {\n                            if (firstProp == \"text\")\n                                updateText(_diff, [firstProp, ...nestedProps]);\n                        }\n                        else if (isJqAttribute(node1, node2)) {\n                            if (firstProp == \"value\")\n                                updateAttribute(_diff, [firstProp, ...nestedProps]);\n                        }\n                        else if (isJqFragment(node1, node2)) {\n                        }\n                        else if (isJqElement(node1, node2)) {\n                        }\n                    }\n                    for (const [firstProp, ...nestedProps] of createdChanges) {\n                        if (isJqText(node1, node2)) {\n                        }\n                        else if (isJqAttribute(node1, node2)) {\n                        }\n                        else if (isJqFragment(node1, node2)) {\n                            if (firstProp == \"childNodes\")\n                                createFragment(_diff, [firstProp, ...nestedProps]);\n                        }\n                        else if (isJqElement(node1, node2)) {\n                            if (firstProp == \"childNodes\")\n                                createElement(_diff, [firstProp, ...nestedProps]);\n                        }\n                    }\n                    for (const [firstProp, ...nestedProps] of deletedChanges) {\n                        if (isJqFragment(node1, node2)) {\n                            deleteJqFragmentChild(_diff, [firstProp, ...nestedProps]);\n                        }\n                        else if (isJqElement(node1, node2)) {\n                            deleteJqElementChild(_diff, [firstProp, ...nestedProps]);\n                        }\n                        else {\n                            node1.delete.deleteSelf();\n                        }\n                    }\n                    // if ([updatedChanges.length, createdChanges.length, deletedChanges.length].every(x => x == 0)) {\n                    for (const childDiff of _diff.childDiffs)\n                        reconcile(rootNode, _diff.node1, childDiff.node1, childDiff.node2);\n                    // }\n                }\n                function updateAttribute(diff, props) {\n                    if (![diff.node1, diff.node2].every(node => node instanceof JqAttribute))\n                        return this;\n                    const _node1 = diff.node1;\n                    const _node2 = diff.node2;\n                    return _node1.update.setAttribute(_node2.value);\n                }\n                function updateText(diff, props) {\n                    if (![diff.node1, diff.node2].every(node => node instanceof JqText))\n                        return this;\n                    const _node1 = diff.node1;\n                    const _node2 = diff.node2;\n                    _node1.update.setText(_node2.text);\n                }\n                function createElement(diff, [firstProp, _childNode]) {\n                    if (![diff.node1, diff.node2].every(node => node instanceof JqElement))\n                        return this;\n                    const _node1 = diff.node1;\n                    const _node2 = diff.node2;\n                    const childNode = _childNode;\n                    childNode.jqParent = _node1.jqParent;\n                    childNode.nodePosition = _node1.childNodes.length;\n                    _node1.childNodes.splice(_node1.childNodes.length, 0, childNode);\n                    childNode.attachTo(_node1);\n                    return this;\n                }\n                function createFragment(diff, [firstProp, _childNode]) {\n                    if (![diff.node1, diff.node2].every(node => node instanceof JqFragment))\n                        return this;\n                    const _node1 = diff.node1;\n                    const _node2 = diff.node2;\n                    const childNode = _childNode;\n                    childNode.jqParent = _node1.jqParent;\n                    childNode.nodePosition = _node1.childNodes.length;\n                    _node1.childNodes.splice(_node1.childNodes.length, 0, childNode);\n                    childNode.attachTo(_node1);\n                    return this;\n                }\n                function deleteJqFragmentChild(diff, [firstProp, _childNode]) {\n                    const _node1 = diff.node1;\n                    const _node2 = diff.node2;\n                    const childNode = _childNode;\n                    childNode.delete.deleteSelf();\n                }\n                function deleteJqElementChild(diff, [firstProp, _childNode]) {\n                    const _node1 = diff.node1;\n                    const _node2 = diff.node2;\n                    const childNode = _childNode;\n                    childNode.delete.deleteSelf();\n                }\n            }\n        };\n        this.callback = callback;\n    }\n    invoke() {\n        const returned = this.callback(this.refProxy);\n        const node = Array.isArray(returned) || isPrimitive(returned)\n            ? convertToJqNode(returned, this.jqParent)\n            : returned;\n        node.nodePosition = this.nodePosition;\n        node.jqParent = this.jqParent;\n        return node;\n    }\n    attachTo(node) {\n        if (node instanceof HTMLElement) {\n            const childNode = this.invoke();\n            childNode.attachTo(node);\n        }\n        else if (node instanceof JqElement) {\n            this.jqParent = node;\n            this.returned = this.invoke();\n            this.returned.attachTo(node);\n        }\n        else {\n            throw new Error(`JqError - Cannot attach JqCallback to a node not of instance JqElement or JqText or JqFragment or HTMLElement`);\n        }\n        return this;\n    }\n    toString(indent = 0) {\n        return this.returned?.toString(indent) ?? '';\n    }\n}\nexport class JqEvent {\n    constructor(event, handler) {\n        this.nodePosition = -1;\n        this.handler = (_) => { };\n        this.jqParent = null;\n        this.event = event;\n        this.handler = handler;\n    }\n    attachHandler(element) {\n        element.addEventListener(this.event, this.handler);\n    }\n    detachHandler(element) {\n        element.removeEventListener(this.event, this.handler);\n    }\n    attachTo(node) {\n        if (node instanceof HTMLElement) {\n            this.attachHandler(node);\n        }\n        else if (node instanceof JqElement) {\n            this.attachHandler(node.htmlNode);\n        }\n        else {\n            throw new Error(`JqError - Cannot attach JqEvent '${this.event}' to a node not of instance JqElement or JqFragment or HTMLElement`);\n        }\n        return this;\n    }\n}\nexport const ElementReference = Symbol(\"ElementReference\");\nexport const StateReference = Symbol(\"StateReference\");\nexport class JqReference {\n    constructor(state = {}) {\n        this[_a] = null;\n        this.nodePosition = -1;\n        this.jqParent = null;\n        this.attachTo = (node) => {\n            if (node instanceof HTMLElement) {\n                this[ElementReference] = node;\n            }\n            else if (node instanceof JqElement) {\n                this.jqParent = node;\n                this[ElementReference] = node.htmlNode;\n            }\n            else {\n                throw new Error(`JqError - Cannot attach JqReference to a node not of instance JqElement or JqFragment or HTMLElement`);\n            }\n            return this;\n        };\n        this.deref = () => {\n            return this[ElementReference];\n        };\n        this.refresh = async (callback) => {\n            const result = await callback(this[StateReference]);\n            this.jqParent.update.updateNode();\n            return result;\n        };\n        this[StateReference] = state;\n    }\n}\n_a = ElementReference;\nexport class JqAnimation {\n    constructor(...parameters) {\n        this.domAnimation = null;\n        this.nodePosition = -1;\n        _JqAnimation_parameters.set(this, void 0);\n        this.jqParent = null;\n        __classPrivateFieldSet(this, _JqAnimation_parameters, parameters, \"f\");\n    }\n    attachTo(node) {\n        if (node instanceof HTMLElement) {\n            this.animate(node);\n        }\n        else if (node instanceof JqElement) {\n            this.jqParent = node;\n            this.animate(node.htmlNode);\n        }\n        else {\n            throw new Error(`JqError - Cannot attach JqAnimation to a node not of instance JqElement or JqFragment or HTMLElement`);\n        }\n        return this;\n    }\n    animate(element) {\n        const [_styles, _options, ..._moreOptions] = __classPrivateFieldGet(this, _JqAnimation_parameters, \"f\");\n        const setStartStyles = (styles, ..._) => {\n            const styleNames = Object.keys(styles).filter(styleName => !Array.isArray(styles[styleName]));\n            const _styles = styleNames.map(styleName => {\n                const finalStyleValue = styles[styleName];\n                const initialStyleValue = getComputedStyle(element).getPropertyValue(styleName);\n                return [styleName, [initialStyleValue, finalStyleValue]];\n            });\n            const x = { ...styles, ...Object.fromEntries(_styles) };\n            return x;\n        };\n        let callback = null;\n        let options = (isPrimitive(_options) ? null : _options);\n        options ?? (options = (() => {\n            const [speed, easing, _callback] = [_options, ..._moreOptions];\n            if (_callback)\n                callback = _callback;\n            const option = {\n                duration: speed ?? 400,\n                easing: easing ?? \"linear\",\n                fill: \"forwards\"\n            };\n            return option;\n        })());\n        const __styles = (Array.isArray(_styles)\n            ? _styles.map(x => x instanceof Map ? Object.fromEntries(x) : x)\n            : _styles instanceof Map ? Object.fromEntries(_styles) : _styles);\n        const styles = (Array.isArray(__styles)\n            ? __styles.map(setStartStyles)\n            : setStartStyles(__styles));\n        this.domAnimation = element.animate(styles, options);\n        callback && this.domAnimation.addEventListener(\"finish\", callback);\n        return this.domAnimation;\n    }\n}\n_JqAnimation_parameters = new WeakMap();\nexport class JqCSSProperty {\n    constructor(name, value) {\n        this.nodePosition = -1;\n        this.jqParent = null;\n        this.name = camelToKebab(name).replace(/_/g, '-');\n        this.value = String(value);\n    }\n    attachTo(node) {\n        if (node instanceof HTMLElement) {\n            node.style.setProperty(this.name, this.value);\n        }\n        else if (node instanceof JqElement) {\n            this.jqParent = node;\n        }\n        else {\n            throw new Error(`JqError - Cannot attach JqCSS.Property to a node not of instance JqElement or JqFragment or HTMLElement`);\n        }\n        return this;\n    }\n    toString(indent = 1) {\n        return `${this.name}: ${this.value};`;\n    }\n}\nexport class JqCSSRule {\n    constructor([ruleName, ...ruleArgs], ...styleNodes) {\n        this.nodePosition = -1;\n        this.body = [];\n        this.jqParent = null;\n        this.head = [ruleName, ...ruleArgs];\n        const errorMessage = `JqError - Invalid argument passed to ${this.head.join(' ').trim()}(...)`;\n        this.body = styleNodes.flatMap(styleNode => styleNode instanceof JqCSSProperty || styleNode instanceof JqCSSRule\n            ? styleNode\n            : createPropertyListFromStyleObject(errorMessage, styleNode).nodes);\n    }\n    attachTo(node) {\n        if (node instanceof HTMLElement) {\n            // node.style.setProperty(this.name, this.value)\n        }\n        else if (node instanceof JqElement) {\n            this.jqParent = node;\n        }\n        else {\n            throw new Error(`JqError - Cannot attach JqCSS.Rule to a node not of instance JqElement or JqFragment or HTMLElement`);\n        }\n        return this;\n    }\n    toString(indent = 1) {\n        const space = '\\t'.repeat(indent);\n        let head = this.head.join(' ').trim();\n        return `${head} {\\n${space}${this.body.map(styleNode => styleNode.toString(indent + 1)).join('\\n' + space)}\\n${'\\t'.repeat(indent - 1)}}`;\n    }\n}\nclass JqAttribute {\n    constructor(name, value) {\n        _JqAttribute_name.set(this, '');\n        _JqAttribute_value.set(this, '');\n        this.nodePosition = -1;\n        this.attrNode = null;\n        this.jqParent = null;\n        this.initial = {\n            context: this,\n            createNode() {\n                const jqAttribute = this.context;\n                jqAttribute.attrNode = document.createAttribute(jqAttribute.name);\n                jqAttribute.attrNode.value = jqAttribute.value;\n                return this;\n            }\n        };\n        this.update = {\n            context: this,\n            updateAttribute() {\n                const jqAttribute = this.context;\n                jqAttribute.attrNode.value = jqAttribute.value;\n                return this;\n            },\n            setAttribute(value) {\n                const jqAttribute = this.context;\n                if (value === jqAttribute.value)\n                    return this;\n                jqAttribute.value = value;\n                jqAttribute.attrNode.value = value;\n                return this;\n            }\n        };\n        this.delete = {\n            context: this,\n            deleteSelf() {\n                const jqAttribute = this.context;\n                const jqElement = jqAttribute.jqParent;\n                if (!jqElement)\n                    return this;\n                jqElement.delete.removeAttribute(jqAttribute);\n                jqAttribute.attrNode = null;\n                return this;\n            }\n        };\n        this.name = camelToKebab(name).replace(/_/g, '-');\n        this.value = value;\n    }\n    get name() {\n        return __classPrivateFieldGet(this, _JqAttribute_name, \"f\");\n    }\n    set name(attrName) {\n        __classPrivateFieldSet(this, _JqAttribute_name, attrName, \"f\");\n    }\n    get value() {\n        return __classPrivateFieldGet(this, _JqAttribute_value, \"f\");\n    }\n    set value(attrValue) {\n        __classPrivateFieldSet(this, _JqAttribute_value, attrValue, \"f\");\n    }\n    attachTo(node) {\n        this.initial.createNode();\n        if (node instanceof HTMLElement) {\n            node.setAttributeNode(this.attrNode);\n        }\n        else if (node instanceof JqElement) {\n            this.jqParent = node;\n            node.htmlNode.setAttributeNode(this.attrNode);\n        }\n        else {\n            throw new Error(`JqError - Cannot attach JqAttribute '${this.name}' to a node not of instance JqElement or JqFragment or HTMLElement`);\n        }\n        return this;\n    }\n    static objectToJqAttributes(attrObj) {\n        const errorMessage = `JqError - Invalid argument passed to attr(...)`;\n        if (attrObj === null || typeof attrObj !== \"object\")\n            throw new Error(errorMessage);\n        const attrList = Object.entries(attrObj)\n            .map(([key, value]) => {\n            const _name = camelToKebab(key).replace(/_/g, '-');\n            const _value = String(value);\n            const attribute = new JqAttribute(_name, _value);\n            return attribute;\n        });\n        return new JqList(JqAttribute, attrList);\n    }\n}\n_JqAttribute_name = new WeakMap(), _JqAttribute_value = new WeakMap();\nJqAttribute.List = {\n    from(attrObject) {\n        if (attrObject === null || typeof attrObject !== \"object\")\n            throw new Error(`JqError - Invalid argument passed to attr(...); expected an object.`);\n        const attributes = Object.entries(attrObject)\n            .map(([key, value]) => {\n            const _name = camelToKebab(key).replace(/_/g, '-');\n            const _value = String(value);\n            const attribute = new JqAttribute(_name, _value);\n            return attribute;\n        });\n        return new JqList(JqAttribute, attributes);\n    }\n};\nexport { JqAttribute };\nexport class JqFragment {\n    constructor(childNodes) {\n        this.nodePosition = -1;\n        this.jqParent = null;\n        this.htmlNode = null;\n        this.childNodes = [];\n        this.initial = {\n            context: this,\n            createNode() {\n                const jqFragment = this.context;\n                jqFragment.htmlNode = document.createDocumentFragment().cloneNode();\n                return this;\n            },\n            attachChildren() {\n                const jqFragment = this.context;\n                for (const childNode of jqFragment.childNodes) {\n                    childNode.attachTo(jqFragment);\n                }\n                return this;\n            }\n        };\n        this.update = {\n            context: this,\n            updateNode() {\n                this.updateChildren();\n                return this;\n            },\n            updateChildren() {\n                const jqFragment = this.context;\n                for (const childNode of jqFragment.childNodes) {\n                    childNode.update.updateNode();\n                }\n                return this;\n            },\n            attachChild(childNode) {\n                const jqFragment = this.context;\n                if (jqFragment.jqParent instanceof JqFragment) {\n                    jqFragment.jqParent.update.attachChild(childNode);\n                    return this;\n                }\n                if (jqFragment.jqParent instanceof JqElement) {\n                    const node = jqFragment.jqParent.shadowRoot ?? jqFragment.jqParent.htmlNode;\n                    node.appendChild(childNode.htmlNode);\n                    return this;\n                }\n                return this;\n            }\n        };\n        this.delete = {\n            context: this,\n            deleteSelf() {\n                const jqFragment = this.context;\n                const jqParent = jqFragment.jqParent;\n                const delChildIdx = jqParent.childNodes.findIndex(childNode => Object.is(childNode, jqFragment));\n                if (delChildIdx == -1)\n                    throwError(\"JqInternalError - JqFragment not found in its jqParent.childNodes\");\n                jqParent.childNodes.splice(delChildIdx, 1);\n                jqFragment.childNodes.forEach(childNode => childNode.delete.deleteSelf());\n                return this;\n            }\n        };\n        this.childNodes = childNodes;\n    }\n    attachTo(node) {\n        const attachNode = () => this.initial\n            .createNode()\n            .attachChildren();\n        if (node === null) {\n            attachNode();\n        }\n        else if (node instanceof HTMLElement) {\n            attachNode();\n            node.appendChild(this.htmlNode);\n        }\n        else if (node instanceof JqElement) {\n            this.jqParent = node, attachNode();\n            (node.shadowRoot ?? node.htmlNode).appendChild(this.htmlNode);\n        }\n        else if (node instanceof JqFragment) {\n            this.jqParent = node, attachNode();\n            node.htmlNode.appendChild(this.htmlNode);\n        }\n        else {\n            throw new Error(`JqError - Cannot attach JqFragment to a node not of instance JqElement or JqFragment or HTMLElement`);\n        }\n        return this.toString();\n    }\n    getStateRefValue(prop) {\n        return this.jqParent?.getStateRefValue(prop);\n    }\n    setStateRefValue(prop, value) {\n        return this.jqParent?.setStateRefValue(prop, value);\n    }\n    toString(indent = 0) {\n        return this.childNodes.map(x => x.toString(indent)).join('\\n' + '\\t'.repeat(indent));\n    }\n}\nexport class JqText {\n    constructor(...primitives) {\n        this.nodePosition = -1;\n        this.jqParent = null;\n        this.htmlNode = null;\n        this.text = '';\n        this.initial = {\n            context: this,\n            createNode() {\n                const jqElement = this.context;\n                jqElement.htmlNode = document.createTextNode(jqElement.text);\n                return this;\n            }\n        };\n        this.update = {\n            context: this,\n            updateNode() {\n                return this;\n            },\n            setText(text) {\n                const jqText = this.context;\n                jqText.htmlNode.nodeValue = jqText.text = text;\n            }\n        };\n        this.delete = {\n            context: this,\n            deleteSelf() {\n                const jqText = this.context;\n                const jqParent = jqText.jqParent;\n                const delChildIdx = jqParent.childNodes.findIndex(childNode => Object.is(childNode, jqText));\n                jqParent.childNodes.splice(delChildIdx, 1);\n                jqText.htmlNode.remove();\n                return this;\n            }\n        };\n        this.text = primitives.map(primitive => String(primitive ?? '')).join('');\n    }\n    attachTo(node) {\n        this.initial.createNode();\n        if (node === null) {\n        }\n        else if (node instanceof HTMLElement) {\n            node.appendChild(this.htmlNode);\n            return this.toString();\n        }\n        else if (node instanceof JqElement) {\n            this.jqParent = node;\n            (node.shadowRoot ?? node.htmlNode).appendChild(this.htmlNode);\n        }\n        else if (node instanceof JqFragment) {\n            this.jqParent = node;\n            node.htmlNode.appendChild(this.htmlNode);\n        }\n        else {\n            throw new Error(`JqError - Cannot attach JqText to a node not of instance JqElement or JqFragment or HTMLElement`);\n        }\n        return this.toString();\n    }\n    toString(indent = 0) {\n        return this.htmlNode.nodeValue ?? '';\n    }\n}\nexport class JqList {\n    constructor(nodeClass, nodes) {\n        this.nodes = [];\n        this.nodeClass = nodeClass;\n        this.nodes = nodes;\n    }\n    push(node) {\n        if (!(node instanceof this.nodeClass))\n            throw new Error(`JqError - Cannot push node not of instance '${this.nodeClass.name}' into JqList<${this.nodeClass.name}>`);\n        this.nodes.push(node);\n    }\n    pop() {\n        return this.nodes.pop();\n    }\n}\nclass JqElement {\n    constructor(name, props) {\n        this.jqParent = null;\n        this.shadowRoot = null;\n        this.htmlNode = null;\n        this.childNodes = [];\n        this.attributes = [];\n        this.events = [];\n        this.animations = [];\n        this.references = [];\n        this.inlineStyles = [];\n        this.blockStyles = [];\n        this.callbacks = [];\n        this.scopedStyleSheet = null;\n        this.nodePosition = -1;\n        this.initial = {\n            context: this,\n            createNode(recreate = true) {\n                const jqElement = this.context;\n                if (recreate)\n                    jqElement.htmlNode = document.createElement(jqElement.name);\n                return this;\n            },\n            attachAttributes() {\n                const jqElement = this.context;\n                for (const attribute of jqElement.attributes) {\n                    attribute.attachTo(jqElement);\n                }\n                return this;\n            },\n            attachChildren() {\n                const jqElement = this.context;\n                const callbackPosNodePairs = jqElement.callbacks.map(callback => [callback.nodePosition, callback]);\n                for (const childNode of jqElement.childNodes) {\n                    callbackPosNodePairs.forEach(([pos, callback], idx) => attachCallback(idx, childNode.nodePosition, pos, callback));\n                    childNode.attachTo(jqElement);\n                }\n                callbackPosNodePairs.forEach(([pos, callback], idx) => attachCallback(idx, -1, pos, callback, true));\n                return this;\n                function attachCallback(idx, childNodePos, callbackPos, callback, ignorePos = false) {\n                    if (!ignorePos && callbackPos >= childNodePos)\n                        return;\n                    callback.attachTo(jqElement);\n                    callbackPosNodePairs.splice(idx, 1);\n                }\n            },\n            attachEventListeners() {\n                const jqElement = this.context;\n                for (const jqEvent of jqElement.events) {\n                    jqEvent.attachTo(jqElement);\n                }\n                return this;\n            },\n            attachAnimations() {\n                const jqElement = this.context;\n                if (jqElement.animations.length == 0)\n                    return this;\n                observeElement(jqElement.htmlNode, ([entry, observer]) => {\n                    if (entry.isIntersecting) {\n                        for (const animation of jqElement.animations) {\n                            animation.attachTo(jqElement);\n                        }\n                        observer.disconnect();\n                    }\n                });\n                return this;\n            },\n            attachStyles() {\n                const jqElement = this.context;\n                if (jqElement.inlineStyles.length == 0 && jqElement.blockStyles.length == 0)\n                    return this;\n                if (canHaveShadow(jqElement.htmlNode)) {\n                    jqElement.shadowRoot = jqElement.htmlNode.attachShadow({ mode: \"open\" });\n                    const styleSheet = document.createElement(\"style\");\n                    styleSheet.textContent = '';\n                    jqElement.scopedStyleSheet = styleSheet;\n                    jqElement.shadowRoot.appendChild(styleSheet);\n                    const styleProperties = [];\n                    for (const style of jqElement.inlineStyles) {\n                        style.attachTo(jqElement);\n                        styleProperties.push(style);\n                    }\n                    for (const style of jqElement.blockStyles) {\n                        style.attachTo(jqElement);\n                        styleSheet.textContent += '\\n' + style.toString();\n                    }\n                    const stylePropertiesStr = styleProperties.join(\"\\n\\t\");\n                    if (stylePropertiesStr.length > 0)\n                        styleSheet.textContent += `\\n:host {\\n\\t${stylePropertiesStr}\\n}`;\n                    return this;\n                }\n                throw new Error(`JqError - scoped styles are not supported for '${jqElement.name}' element.`);\n            },\n            attachReferences() {\n                const jqElement = this.context;\n                for (const reference of jqElement.references) {\n                    reference.attachTo(jqElement);\n                }\n                return this;\n            },\n            attachCallbacks() {\n                const jqElement = this.context;\n                for (const callback of jqElement.callbacks) {\n                    callback.attachTo(jqElement);\n                }\n                return this;\n            }\n        };\n        this.update = {\n            context: this,\n            updateNode() {\n                this\n                    .updateAttributes()\n                    .updateChildren()\n                    .updateCallbacks();\n                return this;\n            },\n            updateAttributes() {\n                const jqElement = this.context;\n                for (const attribute of jqElement.attributes) {\n                    attribute.update.setAttribute(attribute.value);\n                }\n                return this;\n            },\n            updateChildren() {\n                const jqElement = this.context;\n                for (const childNode of jqElement.childNodes) {\n                    childNode.update.updateNode();\n                }\n                return this;\n            },\n            updateStyles() {\n                const jqElement = this.context;\n                for (const style of jqElement.inlineStyles) {\n                    // style.update.updateNode()\n                }\n                return this;\n            },\n            updateCallbacks() {\n                const jqElement = this.context;\n                for (const callback of jqElement.callbacks) {\n                    callback.update.updateCallback();\n                }\n                return this;\n            }\n        };\n        this.delete = {\n            context: this,\n            removeAttribute(jqAttribute) {\n                const jqElement = this.context;\n                const indexOfAttr = jqElement.attributes.indexOf(jqAttribute);\n                if (indexOfAttr != -1)\n                    jqElement.attributes.splice(indexOfAttr, 1);\n                jqElement.htmlNode.removeAttribute(jqAttribute.name);\n                return this;\n            },\n            deleteSelf() {\n                const jqElement = this.context;\n                const jqParent = jqElement.jqParent;\n                const delChildIdx = jqParent.childNodes.findIndex(childNode => Object.is(childNode, jqElement));\n                if (delChildIdx == -1)\n                    throwError(\"JqInternalError - JqElement not found in its jqParent.childNodes\");\n                jqParent.childNodes.splice(delChildIdx, 1);\n                jqElement.childNodes.forEach(childNode => childNode.delete.deleteSelf());\n                jqElement.htmlNode.remove();\n                return this;\n            }\n        };\n        this.name = name;\n        Object.assign(this, props);\n    }\n    attachTo(node) {\n        const attachNode = () => this.initial\n            .createNode(isNullish(this.htmlNode))\n            .attachReferences()\n            .attachStyles()\n            .attachAttributes()\n            .attachChildren()\n            .attachEventListeners()\n            .attachAnimations();\n        if (node === null) {\n            attachNode();\n        }\n        else if (node instanceof HTMLElement) {\n            attachNode();\n            node.appendChild(this.htmlNode);\n        }\n        else if (node instanceof JqElement) {\n            this.jqParent = node, attachNode();\n            (node.shadowRoot ?? node.htmlNode).appendChild(this.htmlNode);\n        }\n        else if (node instanceof JqFragment) {\n            this.jqParent = node, attachNode();\n            node.htmlNode.appendChild(this.htmlNode);\n            node.update.attachChild(this);\n        }\n        else {\n            throw new Error(`JqError - Cannot attach JqElement '${this.name}' to a node not of instance JqElement or JqFragment or HTMLElement`);\n        }\n        return this.toString();\n    }\n    getStateRefValue(prop) {\n        const reference = this.references?.find(reference => prop in reference[StateReference]);\n        return reference?.[StateReference][prop] ?? this.jqParent?.getStateRefValue(prop);\n    }\n    setStateRefValue(prop, value) {\n        const reference = this.references?.find(reference => prop in reference[StateReference]);\n        if (reference) {\n            reference[StateReference][prop] = value;\n            this.update.updateNode();\n            return value;\n        }\n        const _value = this.jqParent?.setStateRefValue(prop, value);\n        return _value;\n    }\n    toString(indent = 0) {\n        const emptyTags = [\n            \"area\", \"base\", \"br\",\n            \"col\", \"embed\", \"hr\",\n            \"img\", \"input\", \"link\",\n            \"meta\", \"param\", \"source\",\n            \"track\", \"wbr\"\n        ];\n        const hasElmStartIndent = (length) => length > 0 ? '\\n' + '\\t'.repeat(indent + 1) : '';\n        const hasElmEndIndent = (length) => length > 0 ? '\\n' + '\\t'.repeat(indent) : '';\n        const emptyTagSelfClosure = emptyTags.includes(this.name) ? '/' : '';\n        const childMarkup = this.childNodes.map(x => x.toString(indent + 1)).join('\\n' + '\\t'.repeat(indent + 1));\n        const selfAttrs = this.attributes.map(x => `${x.name} = \"${stringify(x.value)}\"`).join(\" \");\n        const selfCallbacks = this.callbacks.map(x => x.toString(indent + 1)).join('\\n' + '\\t'.repeat(indent));\n        const selfMarkupHead = `<${this.name}${selfAttrs.length ? ' ' : ''}${selfAttrs}${emptyTagSelfClosure}>`;\n        const selfMarkupTail = `${hasElmStartIndent(childMarkup.length || selfCallbacks.length) +\n            childMarkup +\n            (selfCallbacks.length ? hasElmStartIndent(childMarkup.length) + selfCallbacks : '') +\n            hasElmEndIndent(childMarkup.length || selfCallbacks.length)}</${this.name}>`;\n        const selfMarkup = `${selfMarkupHead}${!emptyTagSelfClosure ? selfMarkupTail : ''}`;\n        return selfMarkup;\n    }\n}\nJqElement.custom = (context, name, nodes) => {\n    return new JqElement(name, { ...nodes, htmlNode: context });\n};\nexport { JqElement };\n/**\n *\n * @param {boolean} condition\n * @returns {true | null}\n */\nexport function showIf(condition) {\n    return condition || null;\n}\nexport function observeElement(element, callback) {\n    const observerCallback = callback => (entries, observer) => entries.forEach(entry => callback([entry, observer]));\n    return new IntersectionObserver(observerCallback(callback)).observe(element);\n}\nexport function canHaveShadow(element) {\n    try {\n        return Boolean(element.cloneNode().attachShadow({ mode: \"open\" }));\n    }\n    catch {\n        return false;\n    }\n}\nexport const camelToKebab = (str) => str.replace(/[A-Z]+(?![a-z])|[A-Z]/g, ($, ofs) => (ofs ? \"-\" : \"\") + $.toLowerCase());\nexport function createPropertyListFromStyleObject(errorMessage, styleObject) {\n    const isObject = (value) => value !== null && typeof value == \"object\";\n    if (!isObject(styleObject))\n        throw new Error(errorMessage);\n    const styleProperties = Object.entries(styleObject)\n        .map(([key, value]) => new JqCSSProperty(key, value));\n    return new JqList(JqCSSProperty, styleProperties);\n}\nexport function adjustColor(col, amt) {\n    let usePound = false;\n    if (col[0] == \"#\") {\n        col = col.slice(1);\n        usePound = true;\n    }\n    const num = parseInt(col, 16);\n    let r = (num >> 16) + amt;\n    if (r > 255)\n        r = 255;\n    else if (r < 0)\n        r = 0;\n    let b = ((num >> 8) & 0x00FF) + amt;\n    if (b > 255)\n        b = 255;\n    else if (b < 0)\n        b = 0;\n    let g = (num & 0x0000FF) + amt;\n    if (g > 255)\n        g = 255;\n    else if (g < 0)\n        g = 0;\n    return (usePound ? \"#\" : \"\") + (g | (b << 8) | (r << 16)).toString(16);\n}\nfunction diff(node1, node2) {\n    const nodeComparison = compareJqNodes(node1, node2);\n    return nodeComparison;\n    function compareProps(affected1, affected2) {\n        const diff = {\n            type: Object.getPrototypeOf(affected1.object).constructor,\n            node1: affected1.object,\n            node2: affected2.object,\n            [CREATED]: [],\n            [UPDATED]: [],\n            [DELETED]: [],\n            [UNCHANGED]: [],\n            childDiffs: [],\n        };\n        const deletedProps = affected1.props.filter(prop => isNullish(getPropertyValue(affected2.object, prop)));\n        diff[DELETED] = deletedProps;\n        const createdProps = affected2.props.filter(prop => isNullish(getPropertyValue(affected1.object, prop)));\n        diff[CREATED] = createdProps;\n        const updatedProps = affected1.props.filter(prop => getPropertyValue(affected2.object, prop) !== getPropertyValue(affected1.object, prop));\n        diff[UPDATED] = updatedProps;\n        const unchangedProps = affected1.props.filter(prop => getPropertyValue(affected2.object, prop) === getPropertyValue(affected1.object, prop));\n        diff[UNCHANGED] = unchangedProps;\n        return diff;\n    }\n    function compareJqTexts(node1, node2) {\n        const affected1 = {\n            object: node1,\n            props: [[\"text\"]]\n        };\n        const affected2 = {\n            object: node2,\n            props: [[\"text\"]]\n        };\n        const diff = compareProps(affected1, affected2);\n        return diff;\n    }\n    function compareJqAttributes(jqAttribute1, jqAttribute2) {\n        const affected1 = {\n            object: jqAttribute1,\n            props: [[\"name\"], [\"value\"]]\n        };\n        const affected2 = {\n            object: jqAttribute2,\n            props: [[\"name\"], [\"value\"]]\n        };\n        const diff = compareProps(affected1, affected2);\n        return diff;\n    }\n    function compareJqFragments(node1, node2) {\n        const firstFragChildren = node1.childNodes;\n        const secondFragChildren = node2.childNodes;\n        const _diff = {\n            type: Object.getPrototypeOf(node1).constructor,\n            node1: node1,\n            node2: node2,\n            [CREATED]: [],\n            [UPDATED]: [],\n            [DELETED]: [],\n            [UNCHANGED]: [],\n            childDiffs: [],\n        };\n        for (let i = 0; i < Math.max(firstFragChildren.length, secondFragChildren.length); i++) {\n            const firstFragChild = firstFragChildren[i];\n            const secondFragChild = secondFragChildren[i];\n            if (firstFragChild === undefined)\n                _diff[CREATED].push([\"childNodes\", secondFragChild]);\n            else if (secondFragChild === undefined)\n                _diff[DELETED].push([\"childNodes\", firstFragChild]);\n            else\n                _diff.childDiffs.push(diff(firstFragChild, secondFragChild));\n        }\n        return _diff;\n    }\n    function compareJqElements(node1, node2) {\n        const firstElemChildren = node1.childNodes;\n        const secondElemChildren = node2.childNodes;\n        const firstElemAttributes = node1.attributes;\n        const secondElemAttributes = node2.attributes;\n        const _diff = {\n            type: Object.getPrototypeOf(node1).constructor,\n            node1: node1,\n            node2: node2,\n            [CREATED]: [],\n            [UPDATED]: [],\n            [DELETED]: [],\n            [UNCHANGED]: [],\n            childDiffs: [],\n        };\n        for (let i = 0; i < Math.max(firstElemChildren.length, secondElemChildren.length); i++) {\n            const firstElemChild = firstElemChildren[i];\n            const secondElemChild = secondElemChildren[i];\n            if (firstElemChild === undefined)\n                _diff[CREATED].push([\"childNodes\", i + \"\"]);\n            else if (secondElemChild === undefined)\n                _diff[DELETED].push([\"childNodes\", i + \"\"]);\n            else\n                _diff.childDiffs.push(diff(firstElemChild, secondElemChild));\n        }\n        for (let i = 0; i < Math.max(firstElemAttributes.length, secondElemAttributes.length); i++) {\n            const firstElemAttribute = firstElemAttributes[i];\n            const secondElemAttribute = secondElemAttributes[i];\n            if (firstElemAttribute === undefined)\n                _diff[CREATED].push([\"attributes\", i + '']);\n            else if (secondElemAttribute === undefined)\n                _diff[DELETED].push([\"attributes\", i + '']);\n            else\n                _diff.childDiffs.push(diff(firstElemAttribute, secondElemAttribute));\n        }\n        return _diff;\n    }\n    function compareJqNodes(node1, node2) {\n        if (isJqElement(node1) && isJqElement(node2))\n            return compareJqElements(node1, node2);\n        if (isJqFragment(node1) && isJqFragment(node2))\n            return compareJqFragments(node1, node2);\n        if (isJqAttribute(node1) && isJqAttribute(node2))\n            return compareJqAttributes(node1, node2);\n        if (isJqText(node1) && isJqText(node2))\n            return compareJqTexts(node1, node2);\n        return compareJqGenericNodes(node1, node2);\n    }\n    function compareJqGenericNodes(node1, node2) {\n        const _diff = {\n            type: Object.getPrototypeOf(node1).constructor,\n            node1: node1,\n            node2: node2,\n            [CREATED]: [],\n            [UPDATED]: [],\n            [DELETED]: [],\n            [UNCHANGED]: [],\n            childDiffs: [],\n        };\n        const [isNode1, isNode2] = [isNullish(node1), isNullish(node2)];\n        if (isNode1)\n            _diff[CREATED].push([\"self\"]);\n        if (isNode2)\n            _diff[DELETED].push([\"self\"]);\n        if (isNode1 || isNode2)\n            return _diff;\n        const indexOfNode1 = node1.jqParent.childNodes.findIndex(x => Object.is(node1, x));\n        _diff[UPDATED].push([\"childNodes\", indexOfNode1 + '']);\n        return _diff;\n    }\n}\nexport const validHTMLElements = [\n    \"a\",\n    \"address\",\n    \"article\",\n    \"aside\",\n    \"audio\",\n    \"b\",\n    \"base\",\n    \"bdo\",\n    \"br\",\n    \"button\",\n    \"canvas\",\n    \"caption\",\n    \"cite\",\n    \"code\",\n    \"col\",\n    \"colgroup\",\n    \"command\",\n    \"data\",\n    \"datalist\",\n    \"dd\",\n    \"del\",\n    \"details\",\n    \"dfn\",\n    \"dialog\",\n    \"div\",\n    \"dl\",\n    \"dt\",\n    \"em\",\n    \"embed\",\n    \"fieldset\",\n    \"figure\",\n    \"figcaption\",\n    \"footer\",\n    \"form\",\n    \"h1\",\n    \"h2\",\n    \"h3\",\n    \"h4\",\n    \"h5\",\n    \"h6\",\n    \"head\",\n    \"header\",\n    \"hgroup\",\n    \"hr\",\n    \"html\",\n    \"i\",\n    \"img\",\n    \"input\",\n    \"ins\",\n    \"kbd\",\n    \"label\",\n    \"legend\",\n    \"li\",\n    \"link\",\n    \"main\",\n    \"map\",\n    \"mark\",\n    \"math\",\n    \"meter\",\n    \"nav\",\n    \"noscript\",\n    \"object\",\n    \"ol\",\n    \"optgroup\",\n    \"option\",\n    \"output\",\n    \"p\",\n    \"param\",\n    \"pre\",\n    \"progress\",\n    \"portal\",\n    \"q\",\n    \"ruby\",\n    \"s\",\n    \"section\",\n    \"small\",\n    \"span\",\n    \"strike\",\n    \"tt\",\n    \"u\",\n    \"var\",\n    \"video\",\n    \"wbr\",\n    \"abbr\",\n    \"area\",\n    \"bdi\",\n    \"blockquote\",\n    \"body\",\n    \"iframe\",\n    \"menu\",\n    \"meta\",\n    \"picture\",\n    \"rb\",\n    \"rp\",\n    \"rt\",\n    \"rtc\",\n    \"samp\",\n    \"script\",\n    \"select\",\n    \"slot\",\n    \"source\",\n    \"strong\",\n    \"style\",\n    \"sub\",\n    \"summary\",\n    \"sup\",\n    \"table\",\n    \"tbody\",\n    \"td\",\n    \"template\",\n    \"textarea\",\n    \"tfoot\",\n    \"th\",\n    \"thead\",\n    \"time\",\n    \"title\",\n    \"tr\",\n    \"track\",\n    \"ul\",\n];\n","var __setFunctionName = (this && this.__setFunctionName) || function (f, name, prefix) {\n    if (typeof name === \"symbol\") name = name.description ? \"[\".concat(name.description, \"]\") : \"\";\n    return Object.defineProperty(f, \"name\", { configurable: true, value: prefix ? \"\".concat(prefix, \" \", name) : name });\n};\nimport { JqEvent, getNodes, escapeHTMLEntities, stringify, JqAnimation, isPrimitive, JqReference, JqElement, JqCSSProperty, JqFragment, JqText, JqCSSRule, JqAttribute, StateReference, JqNodeReference, validHTMLElements, camelToKebab } from \"./utility.js\";\nconst scopedStyleSheets = new WeakMap();\nconst CustomElements = Symbol(\"CustomElements\");\n/**\n * @preserve\n * @typedef {import(\"./utility.js\").JqElement} JqElement\n * @typedef {import(\"./utility.js\").JqAttribute} JqAttribute\n * @typedef {import(\"./utility.js\").JqCSSProperty} JqCSSProperty\n * @typedef {import(\"./utility.js\").JqCSSRule} JqCSSRule\n * @typedef {import(\"./utility.js\").JqReference} JqReference\n * @typedef {import(\"./utility.js\").JqFragment} JqFragment\n * @typedef {import(\"./utility.js\").JqAnimation} JqAnimation\n * @typedef {import(\"./utility.js\").JqCallback} JqCallback\n * @typedef {import(\"./utility.js\").JqEvent} JqEvent\n * @typedef {import(\"./utility.js\").JqText} JqText\n * @typedef {import(\"./utility.js\").JqList} JqList\n * @typedef {null | undefined | number | string | symbol | bigint} Primitive\n * @typedef {JqElement | JqAttribute | JqCSSProperty | JqCSSRule | JqAnimation | JqEvent | JqReference | JqFragment | JqText | JqCallback} JqNode\n * @typedef {{\n *\t\tglobalize: (_globalThis?: object) => void,\n *\t\t[name: string]: (...nodes: Array<JqNode>) => JqElement\n *\t}} Natives\n * @typedef {\n *\t((name: string, parent?: typeof HTMLElement) => (...nodes: JqNode[]) => JqElement) &\n *\t{[CustomElements]: string[]}\n * } Customs\n */\n/**\n * @preserve\n * @type {Natives}\n */\nexport const natives = new Proxy({}, {\n    get(target, prop) {\n        if (typeof prop == \"symbol\")\n            return target[prop];\n        if (prop == \"globalize\")\n            return globalize;\n        return (...nodes) => new JqElement(prop, getNodes(nodes));\n    }\n});\nfunction globalize(_globalThis) {\n    validHTMLElements\n        .forEach(element => (_globalThis ?? globalThis)[element] = natives[element]);\n}\n/**\n * @preserve\n * @type {(text: Primitive) => JqText}\n */\nconst text = new Proxy(_text, {});\n/**\n * @preserve\n * @type {\n * ((attrObj: { [x: string]: Primitive }) => JqList<JqAttribute, typeof JqAttribute>) & {\n *\t\t[x: string]: JqAttribute\n * }}\n */\nconst attr = new Proxy(_attr, {\n    get(target, prop) {\n        if (typeof prop == \"symbol\")\n            return target[prop];\n        return (value) => createAttribute(prop, value);\n    }\n});\n/**\n * @preserve\n * @type {\n * ((event?: Event, ...a: unknown[]) => JqEvent) & {\n * \t\t[eventName: string]: (handler: (event?: Event, ...a: unknown[]) => unknown) => JqEvent\n * }}\n */\nexport const on = new Proxy({}, {\n    get(target, prop) {\n        if (typeof prop == \"symbol\")\n            return target[prop];\n        return (handler) => new JqEvent(prop, handler);\n    }\n});\n/**\n * @preserve\n * @type {\n * ((styleObj: { [x: string]: Primitive }) => JqCSSRule) & {\n*\t\t[x: string]: JqCSSProperty\n* }}\n */\nexport const css = new Proxy(_css, {\n    get(target, prop) {\n        if (typeof prop == \"symbol\")\n            return target[prop];\n        return (value) => {\n            const jqCSSProperty = new JqCSSProperty(prop, value);\n            return jqCSSProperty;\n        };\n    }\n});\nconst _custom = Object.assign(((name, parent = HTMLElement) => {\n    var _a, _b;\n    if (customElements.get(name))\n        throw new Error(`JqError - custom element '${name}' was already defined`);\n    _custom[CustomElements].push(name);\n    const _JqElement = Symbol(\"_JqElement\");\n    const node = (_b = class extends parent {\n            constructor(name, nodes) {\n                super();\n                node[_JqElement] = JqElement.custom(this, name, getNodes(nodes));\n            }\n        },\n        _a = _JqElement,\n        __setFunctionName(_b, \"node\"),\n        _b[_a] = null,\n        _b);\n    customElements.define(name, node);\n    return (...nodes) => (new node(name, nodes), node[_JqElement]);\n}), { [CustomElements]: [] });\n/**\n * @preserve\n * @type {Customs} custom\n*/\nexport const custom = new Proxy(_custom, {\n    get(target, prop) {\n        if (typeof prop == \"symbol\")\n            return target[prop];\n        return target(camelToKebab(prop));\n    }\n});\nfunction createAttribute(name, value) {\n    const _value = isPrimitive(value) ? String(value) : stringify(value);\n    return new JqAttribute(name, _value);\n}\nfunction _attr(attrObj) {\n    const attrList = JqAttribute.objectToJqAttributes(attrObj);\n    return attrList;\n}\nfunction createTextNode(value) {\n    const text = isPrimitive(value) ? String(value) : stringify(value);\n    return new JqText(text);\n}\nfunction _text(strs, ...values) {\n    let _strs = strs;\n    if (Array.isArray(strs))\n        _strs = escapeHTMLEntities(strs.reduce((acc, curr, i) => \"\" + acc + (curr ?? \"\") + (stringify(values[i]) ?? \"\"), \"\"));\n    else if (typeof _strs == \"string\")\n        _strs = escapeHTMLEntities(_strs);\n    return createTextNode(_strs);\n}\n/**\n * @preserve\n * @param {Array<Primitive | JqElement | JqText | JqFragment>} childNodes\n * @returns {JqFragment}\n */\nfunction fragment(..._childNodes) {\n    const { childNodes } = getNodes(_childNodes);\n    return new JqFragment(childNodes);\n}\n/**\n * @preserve\n * @type {(styles: AnimationStyles, ...options: [speed?: number | \"fast\" | \"slow\" | undefined, easing?: string | undefined, callback?: ((..._: unknown[]) => unknown) | undefined] | [option: AnimationOptions])) => JqAnimation}\n */\nexport function animate(...parameters) {\n    return new JqAnimation(...parameters);\n}\nfunction _css(...args) {\n    const [ruleName, ...ruleArgs] = args;\n    if (args.length == 1 && !isPrimitive(ruleName)) {\n        const rule = new JqCSSRule([\":host\", ...ruleArgs], ruleName);\n        return rule;\n    }\n    return (...styleNodes) => {\n        const rule = new JqCSSRule([ruleName, ...ruleArgs], ...styleNodes);\n        return rule;\n    };\n}\n/**\n * @preserve\n * @param {{ [x: string | symbol]: unknown } | undefined} state\n * @returns {JqReference}\n */\nexport function ref(state) {\n    const refObj = new JqReference(state ?? {});\n    const refProxy = new Proxy(refObj, {\n        get(target, prop) {\n            if (prop == JqNodeReference)\n                return target;\n            if (typeof prop == \"symbol\")\n                return target[prop];\n            else if (prop == \"deref\")\n                return target.deref;\n            else if (prop == \"refresh\")\n                return target.refresh;\n            else if (prop == \"attachTo\")\n                return target.attachTo;\n            else {\n                return target[StateReference][prop];\n            }\n        },\n        set(target, prop, value) {\n            if (typeof prop == \"symbol\")\n                return target[prop] = value;\n            target.jqParent?.setStateRefValue(prop, value);\n            return true;\n        }\n    });\n    return refProxy;\n}\nexport const nodes = { attr, text, fragment };\nexport { pathSetter, showIf, getNodes } from \"./utility.js\";\n"],"names":["_a","_JqAnimation_parameters","_JqAttribute_name","_JqAttribute_value","__classPrivateFieldSet","this","receiver","state","value","kind","f","TypeError","has","call","set","__classPrivateFieldGet","get","pathSetter","rootPath","relativePath","replace","isPrimitive","test","Object","isJqElement","xs","every","x","JqElement","isJqAttribute","JqAttribute","isJqFragment","JqFragment","isJqText","JqText","CREATED","Symbol","UPDATED","DELETED","UNCHANGED","getJqNodeConstructors","JqCSSProperty","JqCSSRule","JqAnimation","JqEvent","JqReference","throwError","e","Error","JqNodeReference","getNodes","nodes","childNodes","attributes","events","references","animations","callbacks","inlineStyles","blockStyles","childNodeClasses","i","node","entries","some","childNodeClass","_node","nodePosition","push","JqList","nodeClass","forEach","attribute","Array","isArray","convertToJqNode","jqNode","map","jqFragment","childNode","jqParent","convertToJqFragment","jqText","convertToJqText","jqCallback","JqCallback","convertToJqCallback","ctor","getPropertyValue","object","props","result","length","isNullish","escapeHTMLEntities","text","replacer","t","DOMParser","parseFromString","documentElement","textContent","stringify","String","JSON","constructor","callback","returned","_","refProxy","Proxy","context","target","prop","getStateRefValue","setStateRefValue","update","updateCallback","oldNode","reconcile","rootNode","parentNode","newNode","_diff","diff","node1","node2","updatedChanges","createdChanges","deletedChanges","firstProp","nestedProps","updateText","updateAttribute","createFragment","createElement","deleteJqFragmentChild","deleteJqElementChild","delete","deleteSelf","childDiff","childDiffs","invoke","_node1","_node2","setAttribute","setText","_childNode","splice","attachTo","HTMLElement","toString","indent","event","handler","attachHandler","element","addEventListener","detachHandler","removeEventListener","htmlNode","ElementReference","StateReference","deref","refresh","async","updateNode","parameters","domAnimation","animate","_styles","_options","_moreOptions","setStartStyles","styles","keys","filter","styleName","finalStyleValue","getComputedStyle","fromEntries","options","speed","easing","_callback","duration","fill","__styles","Map","WeakMap","name","camelToKebab","style","setProperty","ruleName","ruleArgs","styleNodes","body","head","errorMessage","join","trim","flatMap","styleNode","styleObject","styleProperties","key","createPropertyListFromStyleObject","space","repeat","attrNode","initial","createNode","jqAttribute","document","createAttribute","jqElement","removeAttribute","attrName","attrValue","setAttributeNode","static","attrObj","attrList","_name","_value","List","from","attrObject","createDocumentFragment","cloneNode","attachChildren","updateChildren","attachChild","shadowRoot","appendChild","delChildIdx","findIndex","is","attachNode","primitives","createTextNode","nodeValue","remove","primitive","pop","scopedStyleSheet","recreate","attachAttributes","callbackPosNodePairs","pos","idx","attachCallback","childNodePos","callbackPos","ignorePos","attachEventListeners","jqEvent","attachAnimations","IntersectionObserver","observer","entry","observerCallback","isIntersecting","animation","disconnect","observe","attachStyles","Boolean","attachShadow","mode","canHaveShadow","styleSheet","stylePropertiesStr","attachReferences","reference","attachCallbacks","updateAttributes","updateCallbacks","updateStyles","indexOfAttr","indexOf","assign","find","hasElmStartIndent","emptyTagSelfClosure","includes","childMarkup","selfAttrs","selfCallbacks","selfMarkupHead","selfMarkupTail","showIf","condition","custom","str","$","ofs","toLowerCase","nodeComparison","firstElemChildren","secondElemChildren","firstElemAttributes","secondElemAttributes","type","getPrototypeOf","Math","max","firstElemChild","secondElemChild","undefined","firstElemAttribute","secondElemAttribute","compareJqElements","firstFragChildren","secondFragChildren","firstFragChild","secondFragChild","compareJqFragments","jqAttribute1","jqAttribute2","compareProps","compareJqAttributes","affected1","affected2","compareJqTexts","isNode1","isNode2","indexOfNode1","compareJqGenericNodes","compareJqNodes","deletedProps","createdProps","updatedProps","unchangedProps","validHTMLElements","__setFunctionName","prefix","description","concat","defineProperty","configurable","CustomElements","natives","globalize","_globalThis","globalThis","strs","values","_strs","reduce","acc","curr","attr","objectToJqAttributes","on","css","args","_custom","parent","_b","customElements","_JqElement","super","define","ref","refObj","fragment","_childNodes"],"mappings":"AAAA,IAWIA,EAAIC,EAAyBC,EAAmBC,EAXhDC,EAA0BC,MAAQA,KAAKD,wBAA2B,SAAUE,EAAUC,EAAOC,EAAOC,EAAMC,GAC1G,GAAa,MAATD,EAAc,MAAM,IAAIE,UAAU,kCACtC,GAAa,MAATF,IAAiBC,EAAG,MAAM,IAAIC,UAAU,iDAC5C,GAAqB,mBAAVJ,EAAuBD,IAAaC,IAAUG,GAAKH,EAAMK,IAAIN,GAAW,MAAM,IAAIK,UAAU,2EACvG,MAAiB,MAATF,EAAeC,EAAEG,KAAKP,EAAUE,GAASE,EAAIA,EAAEF,MAAQA,EAAQD,EAAMO,IAAIR,EAAUE,GAASA,CACxG,EACIO,EAA0BV,MAAQA,KAAKU,wBAA2B,SAAUT,EAAUC,EAAOE,EAAMC,GACnG,GAAa,MAATD,IAAiBC,EAAG,MAAM,IAAIC,UAAU,iDAC5C,GAAqB,mBAAVJ,EAAuBD,IAAaC,IAAUG,GAAKH,EAAMK,IAAIN,GAAW,MAAM,IAAIK,UAAU,4EACvG,MAAgB,MAATF,EAAeC,EAAa,MAATD,EAAeC,EAAEG,KAAKP,GAAYI,EAAIA,EAAEF,MAAQD,EAAMS,IAAIV,EACxF,EAOO,SAASW,EAAWC,GACvB,OAAO,SAAUC,GACb,OAAOD,EAASE,QAAQ,SAAU,IAAM,IACpCD,EAAaC,QAAQ,mBAAoB,GACrD,CACA,CACO,SAASC,EAAYC,GACxB,OAAOA,IAASC,OAAOD,EAC3B,CACA,MAAME,EAAc,IAAIC,IAAOA,EAAGC,OAAMC,GAAKA,aAAaC,YACpDC,EAAgB,IAAIJ,IAAOA,EAAGC,OAAMC,GAAKA,aAAaG,cACtDC,EAAe,IAAIN,IAAOA,EAAGC,OAAMC,GAAKA,aAAaK,aACrDC,EAAW,IAAIR,IAAOA,EAAGC,OAAMC,GAAKA,aAAaO,SACjDC,EAAUC,OAAO,WACjBC,EAAUD,OAAO,WACjBE,EAAUF,OAAO,WACjBG,EAAYH,OAAO,aACnBI,EAAwB,IAAM,CAACZ,UAAWE,YAAaW,cAAeC,UAAWC,YAAaC,QAASC,YAAab,WAAYE,QACzHY,EAAcC,IAAQ,MAAM,IAAIC,MAAMD,EAAE,EACxCE,EAAkBb,OAAO,mBAY/B,SAASc,EAASC,GACrB,MAAMC,EAAa,GACbC,EAAa,GACbC,EAAS,GACTC,EAAa,GACbC,EAAa,GACbC,EAAY,GACZC,EAAe,GACfC,EAAc,GACdC,EAAmB,CAAChC,UAAWI,WAAYE,QACjD,IAAK,MAAO2B,EAAGC,KAASX,EAAMY,UAC1B,GAAIH,EAAiBI,MAAKC,GAAkBH,aAAgBG,IAAiB,CACzE,MAAMC,EAAQJ,EACdI,EAAMC,aAAeN,EACrBT,EAAWgB,KAAKF,EACnB,MACI,GAAIJ,aAAgBhC,YACrBgC,EAAKK,aAAeN,EACpBR,EAAWe,KAAKN,QAEf,GAAIA,aAAgBO,QAAUP,EAAKQ,YAAcxC,YAClDgC,EAAKX,MAAMoB,SAASC,IAChBA,EAAUL,aAAeN,EACzBR,EAAWe,KAAKI,EAAU,SAG7B,GAAIV,aAAgBlB,QACrBkB,EAAKK,aAAeN,EACpBP,EAAOc,KAAKN,QAEX,GAAIA,aAAgBjB,YAAa,CAClC,MAAMqB,EAAQJ,EAAKb,GACnBiB,EAAMC,aAAeN,EACrBN,EAAWa,KAAKF,EACnB,MACI,GAAIJ,aAAgBnB,YACrBmB,EAAKK,aAAeN,EACpBL,EAAWY,KAAKN,QAEf,GAAIA,aAAgBrB,cACrBqB,EAAKK,aAAeN,EACpBH,EAAaU,KAAKN,QAEjB,GAAIA,aAAgBpB,UACrBoB,EAAKK,aAAeN,EACpBF,EAAYS,KAAKN,QAEhB,GAAIW,MAAMC,QAAQZ,GAAO,CAC1B,MAAMI,EAAQS,EAAgBb,EAAM,MACpCI,EAAMC,aAAeN,EACrBT,EAAWgB,KAAKF,EACnB,MACI,GAAmB,mBAARJ,EAAoB,CAChC,MAAMI,EAAQS,EAAgBb,EAAM,MACpCI,EAAMC,aAAeN,EACrBJ,EAAUW,KAAKF,EAClB,MACI,GAAI7C,EAAYyC,GAAO,CACxB,MAAMI,EAAQS,EAAgBb,EAAM,MACpCI,EAAMC,aAAeN,EACrBT,EAAWgB,KAAKF,EACnB,CAEL,MAAO,CACHd,aAAYC,aACZC,SAAQC,aACRC,aAAYE,eACZC,cAAaF,YAErB,CACO,SAASkB,EAAgBnE,EAAOoE,GAqBnC,OAAIH,MAAMC,QAAQlE,GAVU,CAACA,IACzB,MAAM4C,EAAa5C,EAAMqE,KAAIlD,GAAKgD,EAAgBhD,EAAG,QAC/CmD,EAAa,IAAI9C,WAAWoB,GAMlC,OALAA,EAAWmB,SAAQ,CAACQ,EAAWlB,KAC3BkB,EAAUC,SAAWF,EACrBC,EAAUZ,aAAeN,CAAC,IAE9BiB,EAAWE,SAAWJ,EACfE,CAAU,EAGVG,CAAoBzE,GAC3Ba,EAAYb,GAtBQ,CAACA,IACrB,MAAM0E,EAAS,IAAIhD,OAAO1B,GAAS,IAEnC,OADA0E,EAAOF,SAAWJ,EACXM,CAAM,EAoBNC,CAAgB3E,GACP,mBAATA,EAnBiB,CAACA,IACzB,MAAM4E,EAAa,IAAIC,WAAW7E,GAElC,OADA4E,EAAWJ,SAAWJ,EACfQ,CAAU,EAiBVE,CAAoB9E,GAC3BgC,IAAwBwB,MAAKuB,GAAQ/E,aAAiB+E,IAC/C/E,EACJsC,EAAW,wDACtB,CACA,MAAM0C,EAAmB,CAACC,EAAQC,KAC9B,IAAIC,EAASF,EACb,IAAK,IAAI5B,EAAI,EAAGA,EAAI6B,EAAME,OAAQ/B,IAE9B,GADA8B,EAASA,IAASD,EAAM7B,IACpBgC,EAAUF,GACV,OAAOA,EAEf,OAAOA,CAAM,EAMV,SAASG,EAAmBC,GAC/B,MAEMC,EAAW,CAACC,EAAGlD,KAAM,IAAImD,WAAYC,gBAAgBpD,EAAG,aAAaqD,gBAAgBC,aAAe,GAG1G,OAFcN,EAAK3E,QAHE,wBAGoB4E,GACpC5E,QAHgB,kBAGM4E,EAE/B,CACO,SAASM,EAAU9F,GACtB,OAAOa,EAAYb,GAAS+F,OAAO/F,GAAS,IAAMgG,KAAKF,UAAU9F,EACrE,CACO,SAASqF,EAAUrF,GACtB,OAAOA,OACX,CACO,MAAM6E,WACToB,YAAYC,GACRrG,KAAK8D,cAAgB,EACrB9D,KAAK2E,SAAW,KAChB3E,KAAKsG,SAAW,KAChBtG,KAAKqG,SAAYE,GAAM,KACvBvG,KAAKwG,SAAW,IAAIC,MAAM,CAAEC,QAAS1G,MAAQ,CACzCW,IAAG,CAACgG,EAAQC,IACDD,EAAOD,QAAQ/B,UAAUkC,iBAAiBD,GAErDnG,IAAG,CAACkG,EAAQC,EAAMzG,KACdwG,EAAOD,QAAQ/B,UAAUmC,iBAAiBF,EAAMzG,IACzC,KAGfH,KAAK+G,OAAS,CACVL,QAAS1G,KACTgH,iBACI,MAAMjC,EAAa/E,KAAK0G,QACxB,GAA4B,OAAxB3B,EAAWuB,SACX,OAAOtG,KACX,MAAMiH,EAAUlC,EAAWuB,SAI3B,OACA,SAASY,EAAUC,EAAUC,EAAYH,EAASI,GAC9C,MAAMC,EAAQC,EAAKN,EAASI,GACtBG,EAAQF,EAAME,MACdC,EAAQH,EAAMG,MACdC,EAAiBJ,EAAMtF,GACvB2F,EAAiBL,EAAMxF,GACvB8F,EAAiBN,EAAMrF,GAC7B,IAAK,MAAO4F,KAAcC,KAAgBJ,EAClC9F,EAAS4F,EAAOC,GACC,QAAbI,GACAE,EAAWT,EAAO,CAACO,KAAcC,IAEhCtG,EAAcgG,EAAOC,GACT,SAAbI,GACAG,EAAgBV,EAAO,CAACO,KAAcC,IAErCpG,EAAa8F,EAAOC,IAEpBtG,EAAYqG,EAAOC,GAGhC,IAAK,MAAOI,KAAcC,KAAgBH,EAClC/F,EAAS4F,EAAOC,IAEXjG,EAAcgG,EAAOC,KAErB/F,EAAa8F,EAAOC,GACR,cAAbI,GACAI,EAAeX,EAAO,CAACO,KAAcC,IAEpC3G,EAAYqG,EAAOC,IACP,cAAbI,GACAK,EAAcZ,EAAO,CAACO,KAAcC,KAGhD,IAAK,MAAOD,KAAcC,KAAgBF,EAClClG,EAAa8F,EAAOC,GACpBU,EAAsBb,EAAO,CAACO,KAAcC,IAEvC3G,EAAYqG,EAAOC,GACxBW,EAAqBd,EAAO,CAACO,KAAcC,IAG3CN,EAAMa,OAAOC,aAIrB,IAAK,MAAMC,KAAajB,EAAMkB,WAC1BtB,EAAUC,EAAUG,EAAME,MAAOe,EAAUf,MAAOe,EAAUd,MAEnE,CApDDP,CADiBD,EACGG,EAAYH,EAFhBlC,EAAW0D,UAGpBzI,KAoDP,SAASgI,EAAgBT,EAAMlC,GAC3B,IAAK,CAACkC,EAAKC,MAAOD,EAAKE,OAAOpG,OAAMoC,GAAQA,aAAgBhC,cACxD,OAAOzB,KACX,MAAM0I,EAASnB,EAAKC,MACdmB,EAASpB,EAAKE,MACpB,OAAOiB,EAAO3B,OAAO6B,aAAaD,EAAOxI,MAC5C,CACD,SAAS4H,EAAWR,EAAMlC,GACtB,IAAK,CAACkC,EAAKC,MAAOD,EAAKE,OAAOpG,OAAMoC,GAAQA,aAAgB5B,SACxD,OAAO7B,KACX,MAAM0I,EAASnB,EAAKC,MACdmB,EAASpB,EAAKE,MACpBiB,EAAO3B,OAAO8B,QAAQF,EAAOjD,KAChC,CACD,SAASwC,EAAcX,GAAOM,EAAWiB,IACrC,IAAK,CAACvB,EAAKC,MAAOD,EAAKE,OAAOpG,OAAMoC,GAAQA,aAAgBlC,YACxD,OAAOvB,KACX,MAAM0I,EAASnB,EAAKC,MACLD,EAAKE,MACpB,MAAM/C,EAAYoE,EAKlB,OAJApE,EAAUC,SAAW+D,EAAO/D,SAC5BD,EAAUZ,aAAe4E,EAAO3F,WAAWwC,OAC3CmD,EAAO3F,WAAWgG,OAAOL,EAAO3F,WAAWwC,OAAQ,EAAGb,GACtDA,EAAUsE,SAASN,GACZ1I,IACV,CACD,SAASiI,EAAeV,GAAOM,EAAWiB,IACtC,IAAK,CAACvB,EAAKC,MAAOD,EAAKE,OAAOpG,OAAMoC,GAAQA,aAAgB9B,aACxD,OAAO3B,KACX,MAAM0I,EAASnB,EAAKC,MACLD,EAAKE,MACpB,MAAM/C,EAAYoE,EAKlB,OAJApE,EAAUC,SAAW+D,EAAO/D,SAC5BD,EAAUZ,aAAe4E,EAAO3F,WAAWwC,OAC3CmD,EAAO3F,WAAWgG,OAAOL,EAAO3F,WAAWwC,OAAQ,EAAGb,GACtDA,EAAUsE,SAASN,GACZ1I,IACV,CACD,SAASmI,EAAsBZ,GAAOM,EAAWiB,IAC9BvB,EAAKC,MACLD,EAAKE,MACFqB,EACRT,OAAOC,YACpB,CACD,SAASF,EAAqBb,GAAOM,EAAWiB,IAC7BvB,EAAKC,MACLD,EAAKE,MACFqB,EACRT,OAAOC,YACpB,CACJ,GAELtI,KAAKqG,SAAWA,CACnB,CACDoC,SACI,MAAMnC,EAAWtG,KAAKqG,SAASrG,KAAKwG,UAC9B/C,EAAOW,MAAMC,QAAQiC,IAAatF,EAAYsF,GAC9ChC,EAAgBgC,EAAUtG,KAAK2E,UAC/B2B,EAGN,OAFA7C,EAAKK,aAAe9D,KAAK8D,aACzBL,EAAKkB,SAAW3E,KAAK2E,SACdlB,CACV,CACDuF,SAASvF,GACL,GAAIA,aAAgBwF,YAAa,CACXjJ,KAAKyI,SACbO,SAASvF,EACtB,KACI,MAAIA,aAAgBlC,WAMrB,MAAM,IAAIoB,MAAM,iHALhB3C,KAAK2E,SAAWlB,EAChBzD,KAAKsG,SAAWtG,KAAKyI,SACrBzI,KAAKsG,SAAS0C,SAASvF,EAI1B,CACD,OAAOzD,IACV,CACDkJ,SAASC,EAAS,GACd,OAAOnJ,KAAKsG,UAAU4C,SAASC,IAAW,EAC7C,EAEE,MAAM5G,QACT6D,YAAYgD,EAAOC,GACfrJ,KAAK8D,cAAgB,EACrB9D,KAAKqJ,QAAW9C,IAAD,EACfvG,KAAK2E,SAAW,KAChB3E,KAAKoJ,MAAQA,EACbpJ,KAAKqJ,QAAUA,CAClB,CACDC,cAAcC,GACVA,EAAQC,iBAAiBxJ,KAAKoJ,MAAOpJ,KAAKqJ,QAC7C,CACDI,cAAcF,GACVA,EAAQG,oBAAoB1J,KAAKoJ,MAAOpJ,KAAKqJ,QAChD,CACDL,SAASvF,GACL,GAAIA,aAAgBwF,YAChBjJ,KAAKsJ,cAAc7F,OAElB,MAAIA,aAAgBlC,WAIrB,MAAM,IAAIoB,MAAM,oCAAoC3C,KAAKoJ,2EAHzDpJ,KAAKsJ,cAAc7F,EAAKkG,SAI3B,CACD,OAAO3J,IACV,EAEE,MAAM4J,EAAmB7H,OAAO,oBAC1B8H,EAAiB9H,OAAO,kBAC9B,MAAMS,YACT4D,YAAYlG,EAAQ,IAChBF,KAAKL,GAAM,KACXK,KAAK8D,cAAgB,EACrB9D,KAAK2E,SAAW,KAChB3E,KAAKgJ,SAAYvF,IACb,GAAIA,aAAgBwF,YAChBjJ,KAAK4J,GAAoBnG,MAExB,MAAIA,aAAgBlC,WAKrB,MAAM,IAAIoB,MAAM,wGAJhB3C,KAAK2E,SAAWlB,EAChBzD,KAAK4J,GAAoBnG,EAAKkG,QAIjC,CACD,OAAO3J,IAAI,EAEfA,KAAK8J,MAAQ,IACF9J,KAAK4J,GAEhB5J,KAAK+J,QAAUC,MAAO3D,IAClB,MAAMf,QAAee,EAASrG,KAAK6J,IAEnC,OADA7J,KAAK2E,SAASoC,OAAOkD,aACd3E,CAAM,EAEjBtF,KAAK6J,GAAkB3J,CAC1B,EAELP,EAAKiK,EACE,MAAMtH,YACT8D,eAAe8D,GACXlK,KAAKmK,aAAe,KACpBnK,KAAK8D,cAAgB,EACrBlE,EAAwBa,IAAIT,UAAM,GAClCA,KAAK2E,SAAW,KAChB5E,EAAuBC,KAAMJ,EAAyBsK,EAAY,IACrE,CACDlB,SAASvF,GACL,GAAIA,aAAgBwF,YAChBjJ,KAAKoK,QAAQ3G,OAEZ,MAAIA,aAAgBlC,WAKrB,MAAM,IAAIoB,MAAM,wGAJhB3C,KAAK2E,SAAWlB,EAChBzD,KAAKoK,QAAQ3G,EAAKkG,SAIrB,CACD,OAAO3J,IACV,CACDoK,QAAQb,GACJ,MAAOc,EAASC,KAAaC,GAAgB7J,EAAuBV,KAAMJ,EAAyB,KAC7F4K,EAAiB,CAACC,KAAWlE,KAC/B,MACM8D,EADanJ,OAAOwJ,KAAKD,GAAQE,QAAOC,IAAcxG,MAAMC,QAAQoG,EAAOG,MACtDpG,KAAIoG,IAC3B,MAAMC,EAAkBJ,EAAOG,GAE/B,MAAO,CAACA,EAAW,CADOE,iBAAiBvB,GAASpE,iBAAiByF,GAC9BC,GAAiB,IAG5D,MADU,IAAKJ,KAAWvJ,OAAO6J,YAAYV,GACrC,EAEZ,IAAIhE,EAAW,KACX2E,EAAWhK,EAAYsJ,GAAY,KAAOA,EAC9CU,IAAYA,EAAU,MAClB,MAAOC,EAAOC,EAAQC,GAAa,CAACb,KAAaC,GAC7CY,IACA9E,EAAW8E,GAMf,MALe,CACXC,SAAUH,GAAS,IACnBC,OAAQA,GAAU,SAClBG,KAAM,WAGb,EAVqB,IAWtB,MAAMC,EAAYlH,MAAMC,QAAQgG,GAC1BA,EAAQ7F,KAAIlD,GAAKA,aAAaiK,IAAMrK,OAAO6J,YAAYzJ,GAAKA,IAC5D+I,aAAmBkB,IAAMrK,OAAO6J,YAAYV,GAAWA,EACvDI,EAAUrG,MAAMC,QAAQiH,GACxBA,EAAS9G,IAAIgG,GACbA,EAAec,GAGrB,OAFAtL,KAAKmK,aAAeZ,EAAQa,QAAQK,EAAQO,GAC5C3E,GAAYrG,KAAKmK,aAAaX,iBAAiB,SAAUnD,GAClDrG,KAAKmK,YACf,EAELvK,EAA0B,IAAI4L,QACvB,MAAMpJ,cACTgE,YAAYqF,EAAMtL,GACdH,KAAK8D,cAAgB,EACrB9D,KAAK2E,SAAW,KAChB3E,KAAKyL,KAAOC,EAAaD,GAAM1K,QAAQ,KAAM,KAC7Cf,KAAKG,MAAQ+F,OAAO/F,EACvB,CACD6I,SAASvF,GACL,GAAIA,aAAgBwF,YAChBxF,EAAKkI,MAAMC,YAAY5L,KAAKyL,KAAMzL,KAAKG,WAEtC,MAAIsD,aAAgBlC,WAIrB,MAAM,IAAIoB,MAAM,2GAHhB3C,KAAK2E,SAAWlB,CAInB,CACD,OAAOzD,IACV,CACDkJ,SAASC,EAAS,GACd,MAAO,GAAGnJ,KAAKyL,SAASzL,KAAKG,QAChC,EAEE,MAAMkC,UACT+D,aAAayF,KAAaC,MAAcC,GACpC/L,KAAK8D,cAAgB,EACrB9D,KAAKgM,KAAO,GACZhM,KAAK2E,SAAW,KAChB3E,KAAKiM,KAAO,CAACJ,KAAaC,GAC1B,MAAMI,EAAe,wCAAwClM,KAAKiM,KAAKE,KAAK,KAAKC,cACjFpM,KAAKgM,KAAOD,EAAWM,SAAQC,GAAaA,aAAqBlK,eAAiBkK,aAAqBjK,UACjGiK,EAijBP,SAA2CJ,EAAcK,GAE5D,GADkBpM,EACJoM,EADwB,OAAVpM,GAAkC,iBAATA,EAEjD,MAAM,IAAIwC,MAAMuJ,GAFH,IAAC/L,EAGlB,MAAMqM,EAAkBtL,OAAOwC,QAAQ6I,GAClC/H,KAAI,EAAEiI,EAAKtM,KAAW,IAAIiC,cAAcqK,EAAKtM,KAClD,OAAO,IAAI6D,OAAO5B,cAAeoK,EACrC,CAvjBcE,CAAkCR,EAAcI,GAAWxJ,OACpE,CACDkG,SAASvF,GACL,GAAIA,aAAgBwF,iBAGf,MAAIxF,aAAgBlC,WAIrB,MAAM,IAAIoB,MAAM,uGAHhB3C,KAAK2E,SAAWlB,CAInB,CACD,OAAOzD,IACV,CACDkJ,SAASC,EAAS,GACd,MAAMwD,EAAQ,KAAKC,OAAOzD,GAE1B,MAAO,GADInJ,KAAKiM,KAAKE,KAAK,KAAKC,aACVO,IAAQ3M,KAAKgM,KAAKxH,KAAI8H,GAAaA,EAAUpD,SAASC,EAAS,KAAIgD,KAAK,KAAOQ,OAAW,KAAKC,OAAOzD,EAAS,KACvI,EAEL,MAAM1H,YACF2E,YAAYqF,EAAMtL,GACdN,EAAkBY,IAAIT,KAAM,IAC5BF,EAAmBW,IAAIT,KAAM,IAC7BA,KAAK8D,cAAgB,EACrB9D,KAAK6M,SAAW,KAChB7M,KAAK2E,SAAW,KAChB3E,KAAK8M,QAAU,CACXpG,QAAS1G,KACT+M,aACI,MAAMC,EAAchN,KAAK0G,QAGzB,OAFAsG,EAAYH,SAAWI,SAASC,gBAAgBF,EAAYvB,MAC5DuB,EAAYH,SAAS1M,MAAQ6M,EAAY7M,MAClCH,IACV,GAELA,KAAK+G,OAAS,CACVL,QAAS1G,KACTgI,kBACI,MAAMgF,EAAchN,KAAK0G,QAEzB,OADAsG,EAAYH,SAAS1M,MAAQ6M,EAAY7M,MAClCH,IACV,EACD4I,aAAazI,GACT,MAAM6M,EAAchN,KAAK0G,QACzB,OAAIvG,IAAU6M,EAAY7M,QAE1B6M,EAAY7M,MAAQA,EACpB6M,EAAYH,SAAS1M,MAAQA,GAFlBH,IAId,GAELA,KAAKqI,OAAS,CACV3B,QAAS1G,KACTsI,aACI,MAAM0E,EAAchN,KAAK0G,QACnByG,EAAYH,EAAYrI,SAC9B,OAAKwI,GAELA,EAAU9E,OAAO+E,gBAAgBJ,GACjCA,EAAYH,SAAW,KAChB7M,MAHIA,IAId,GAELA,KAAKyL,KAAOC,EAAaD,GAAM1K,QAAQ,KAAM,KAC7Cf,KAAKG,MAAQA,CAChB,CACGsL,WACA,OAAO/K,EAAuBV,KAAMH,EAAmB,IAC1D,CACG4L,SAAK4B,GACLtN,EAAuBC,KAAMH,EAAmBwN,EAAU,IAC7D,CACGlN,YACA,OAAOO,EAAuBV,KAAMF,EAAoB,IAC3D,CACGK,UAAMmN,GACNvN,EAAuBC,KAAMF,EAAoBwN,EAAW,IAC/D,CACDtE,SAASvF,GAEL,GADAzD,KAAK8M,QAAQC,aACTtJ,aAAgBwF,YAChBxF,EAAK8J,iBAAiBvN,KAAK6M,cAE1B,MAAIpJ,aAAgBlC,WAKrB,MAAM,IAAIoB,MAAM,wCAAwC3C,KAAKyL,0EAJ7DzL,KAAK2E,SAAWlB,EAChBA,EAAKkG,SAAS4D,iBAAiBvN,KAAK6M,SAIvC,CACD,OAAO7M,IACV,CACDwN,4BAA4BC,GAExB,GAAgB,OAAZA,GAAuC,iBAAZA,EAC3B,MAAM,IAAI9K,MAFO,kDAGrB,MAAM+K,EAAWxM,OAAOwC,QAAQ+J,GAC3BjJ,KAAI,EAAEiI,EAAKtM,MACZ,MAAMwN,EAAQjC,EAAae,GAAK1L,QAAQ,KAAM,KACxC6M,EAAS1H,OAAO/F,GAEtB,OADkB,IAAIsB,YAAYkM,EAAOC,EACzB,IAEpB,OAAO,IAAI5J,OAAOvC,YAAaiM,EAClC,EAEL7N,EAAoB,IAAI2L,QAAW1L,EAAqB,IAAI0L,QAC5D/J,YAAYoM,KAAO,CACfC,KAAKC,GACD,GAAmB,OAAfA,GAA6C,iBAAfA,EAC9B,MAAM,IAAIpL,MAAM,uEACpB,MAAMK,EAAa9B,OAAOwC,QAAQqK,GAC7BvJ,KAAI,EAAEiI,EAAKtM,MACZ,MAAMwN,EAAQjC,EAAae,GAAK1L,QAAQ,KAAM,KACxC6M,EAAS1H,OAAO/F,GAEtB,OADkB,IAAIsB,YAAYkM,EAAOC,EACzB,IAEpB,OAAO,IAAI5J,OAAOvC,YAAauB,EAClC,GAGE,MAAMrB,WACTyE,YAAYrD,GACR/C,KAAK8D,cAAgB,EACrB9D,KAAK2E,SAAW,KAChB3E,KAAK2J,SAAW,KAChB3J,KAAK+C,WAAa,GAClB/C,KAAK8M,QAAU,CACXpG,QAAS1G,KACT+M,aAGI,OAFmB/M,KAAK0G,QACbiD,SAAWsD,SAASe,yBAAyBC,YACjDjO,IACV,EACDkO,iBACI,MAAMzJ,EAAazE,KAAK0G,QACxB,IAAK,MAAMhC,KAAaD,EAAW1B,WAC/B2B,EAAUsE,SAASvE,GAEvB,OAAOzE,IACV,GAELA,KAAK+G,OAAS,CACVL,QAAS1G,KACTiK,aAEI,OADAjK,KAAKmO,iBACEnO,IACV,EACDmO,iBACI,MAAM1J,EAAazE,KAAK0G,QACxB,IAAK,MAAMhC,KAAaD,EAAW1B,WAC/B2B,EAAUqC,OAAOkD,aAErB,OAAOjK,IACV,EACDoO,YAAY1J,GACR,MAAMD,EAAazE,KAAK0G,QACxB,GAAIjC,EAAWE,oBAAoBhD,WAE/B,OADA8C,EAAWE,SAASoC,OAAOqH,YAAY1J,GAChC1E,KAEX,GAAIyE,EAAWE,oBAAoBpD,UAAW,CAG1C,OAFakD,EAAWE,SAAS0J,YAAc5J,EAAWE,SAASgF,UAC9D2E,YAAY5J,EAAUiF,UACpB3J,IACV,CACD,OAAOA,IACV,GAELA,KAAKqI,OAAS,CACV3B,QAAS1G,KACTsI,aACI,MAAM7D,EAAazE,KAAK0G,QAClB/B,EAAWF,EAAWE,SACtB4J,EAAc5J,EAAS5B,WAAWyL,WAAU9J,GAAaxD,OAAOuN,GAAG/J,EAAWD,KAKpF,OAJoB,GAAhB8J,GACA9L,EAAW,qEACfkC,EAAS5B,WAAWgG,OAAOwF,EAAa,GACxC9J,EAAW1B,WAAWmB,SAAQQ,GAAaA,EAAU2D,OAAOC,eACrDtI,IACV,GAELA,KAAK+C,WAAaA,CACrB,CACDiG,SAASvF,GACL,MAAMiL,EAAa,IAAM1O,KAAK8M,QACzBC,aACAmB,iBACL,GAAa,OAATzK,EACAiL,SAEC,GAAIjL,aAAgBwF,YACrByF,IACAjL,EAAK6K,YAAYtO,KAAK2J,eAErB,GAAIlG,aAAgBlC,UACrBvB,KAAK2E,SAAWlB,EAAMiL,KACrBjL,EAAK4K,YAAc5K,EAAKkG,UAAU2E,YAAYtO,KAAK2J,cAEnD,MAAIlG,aAAgB9B,YAKrB,MAAM,IAAIgB,MAAM,uGAJhB3C,KAAK2E,SAAWlB,EAAMiL,IACtBjL,EAAKkG,SAAS2E,YAAYtO,KAAK2J,SAIlC,CACD,OAAO3J,KAAKkJ,UACf,CACDrC,iBAAiBD,GACb,OAAO5G,KAAK2E,UAAUkC,iBAAiBD,EAC1C,CACDE,iBAAiBF,EAAMzG,GACnB,OAAOH,KAAK2E,UAAUmC,iBAAiBF,EAAMzG,EAChD,CACD+I,SAASC,EAAS,GACd,OAAOnJ,KAAK+C,WAAWyB,KAAIlD,GAAKA,EAAE4H,SAASC,KAASgD,KAAK,KAAO,KAAKS,OAAOzD,GAC/E,EAEE,MAAMtH,OACTuE,eAAeuI,GACX3O,KAAK8D,cAAgB,EACrB9D,KAAK2E,SAAW,KAChB3E,KAAK2J,SAAW,KAChB3J,KAAK0F,KAAO,GACZ1F,KAAK8M,QAAU,CACXpG,QAAS1G,KACT+M,aACI,MAAMI,EAAYnN,KAAK0G,QAEvB,OADAyG,EAAUxD,SAAWsD,SAAS2B,eAAezB,EAAUzH,MAChD1F,IACV,GAELA,KAAK+G,OAAS,CACVL,QAAS1G,KACTiK,aACI,OAAOjK,IACV,EACD6I,QAAQnD,GACJ,MAAMb,EAAS7E,KAAK0G,QACpB7B,EAAO8E,SAASkF,UAAYhK,EAAOa,KAAOA,CAC7C,GAEL1F,KAAKqI,OAAS,CACV3B,QAAS1G,KACTsI,aACI,MAAMzD,EAAS7E,KAAK0G,QACd/B,EAAWE,EAAOF,SAClB4J,EAAc5J,EAAS5B,WAAWyL,WAAU9J,GAAaxD,OAAOuN,GAAG/J,EAAWG,KAGpF,OAFAF,EAAS5B,WAAWgG,OAAOwF,EAAa,GACxC1J,EAAO8E,SAASmF,SACT9O,IACV,GAELA,KAAK0F,KAAOiJ,EAAWnK,KAAIuK,GAAa7I,OAAO6I,GAAa,MAAK5C,KAAK,GACzE,CACDnD,SAASvF,GAEL,GADAzD,KAAK8M,QAAQC,aACA,OAATtJ,OAEC,IAAIA,aAAgBwF,YAErB,OADAxF,EAAK6K,YAAYtO,KAAK2J,UACf3J,KAAKkJ,WAEX,GAAIzF,aAAgBlC,UACrBvB,KAAK2E,SAAWlB,GACfA,EAAK4K,YAAc5K,EAAKkG,UAAU2E,YAAYtO,KAAK2J,cAEnD,MAAIlG,aAAgB9B,YAKrB,MAAM,IAAIgB,MAAM,mGAJhB3C,KAAK2E,SAAWlB,EAChBA,EAAKkG,SAAS2E,YAAYtO,KAAK2J,SAIlC,EACD,OAAO3J,KAAKkJ,UACf,CACDA,SAASC,EAAS,GACd,OAAOnJ,KAAK2J,SAASkF,WAAa,EACrC,EAEE,MAAM7K,OACToC,YAAYnC,EAAWnB,GACnB9C,KAAK8C,MAAQ,GACb9C,KAAKiE,UAAYA,EACjBjE,KAAK8C,MAAQA,CAChB,CACDiB,KAAKN,GACD,KAAMA,aAAgBzD,KAAKiE,WACvB,MAAM,IAAItB,MAAM,+CAA+C3C,KAAKiE,UAAUwH,qBAAqBzL,KAAKiE,UAAUwH,SACtHzL,KAAK8C,MAAMiB,KAAKN,EACnB,CACDuL,MACI,OAAOhP,KAAK8C,MAAMkM,KACrB,EAEL,MAAMzN,UACF6E,YAAYqF,EAAMpG,GACdrF,KAAK2E,SAAW,KAChB3E,KAAKqO,WAAa,KAClBrO,KAAK2J,SAAW,KAChB3J,KAAK+C,WAAa,GAClB/C,KAAKgD,WAAa,GAClBhD,KAAKiD,OAAS,GACdjD,KAAKmD,WAAa,GAClBnD,KAAKkD,WAAa,GAClBlD,KAAKqD,aAAe,GACpBrD,KAAKsD,YAAc,GACnBtD,KAAKoD,UAAY,GACjBpD,KAAKiP,iBAAmB,KACxBjP,KAAK8D,cAAgB,EACrB9D,KAAK8M,QAAU,CACXpG,QAAS1G,KACT+M,WAAWmC,GAAW,GAClB,MAAM/B,EAAYnN,KAAK0G,QAGvB,OAFIwI,IACA/B,EAAUxD,SAAWsD,SAAS/E,cAAciF,EAAU1B,OACnDzL,IACV,EACDmP,mBACI,MAAMhC,EAAYnN,KAAK0G,QACvB,IAAK,MAAMvC,KAAagJ,EAAUnK,WAC9BmB,EAAU6E,SAASmE,GAEvB,OAAOnN,IACV,EACDkO,iBACI,MAAMf,EAAYnN,KAAK0G,QACjB0I,EAAuBjC,EAAU/J,UAAUoB,KAAI6B,GAAY,CAACA,EAASvC,aAAcuC,KACzF,IAAK,MAAM3B,KAAayI,EAAUpK,WAC9BqM,EAAqBlL,SAAQ,EAAEmL,EAAKhJ,GAAWiJ,IAAQC,EAAeD,EAAK5K,EAAUZ,aAAcuL,EAAKhJ,KACxG3B,EAAUsE,SAASmE,GAGvB,OADAiC,EAAqBlL,SAAQ,EAAEmL,EAAKhJ,GAAWiJ,IAAQC,EAAeD,GAAM,EAAGD,EAAKhJ,GAAU,KACvFrG,KACP,SAASuP,EAAeD,EAAKE,EAAcC,EAAapJ,EAAUqJ,GAAY,IACrEA,GAAaD,GAAeD,IAEjCnJ,EAAS2C,SAASmE,GAClBiC,EAAqBrG,OAAOuG,EAAK,GACpC,CACJ,EACDK,uBACI,MAAMxC,EAAYnN,KAAK0G,QACvB,IAAK,MAAMkJ,KAAWzC,EAAUlK,OAC5B2M,EAAQ5G,SAASmE,GAErB,OAAOnN,IACV,EACD6P,mBACI,MAAM1C,EAAYnN,KAAK0G,QACvB,OAAmC,GAA/ByG,EAAUhK,WAAWoC,SAmMVgE,EAjMA4D,EAAUxD,SAmM9B,IAAImG,qBADczJ,IAAY,CAAC3C,EAASqM,IAAarM,EAAQQ,SAAQ8L,GAAS3J,EAAS,CAAC2J,EAAOD,MACtEE,EAnMe,EAAED,EAAOD,MACxC,GAAIC,EAAME,eAAgB,CACtB,IAAK,MAAMC,KAAahD,EAAUhK,WAC9BgN,EAAUnH,SAASmE,GAEvB4C,EAASK,YACZ,MA6L2CC,QAAQ9G,IApM7CvJ,KAkMpB,IAAwBuJ,CAxLlB,EACD+G,eACI,MAAMnD,EAAYnN,KAAK0G,QACvB,GAAqC,GAAjCyG,EAAU9J,aAAakC,QAA+C,GAAhC4H,EAAU7J,YAAYiC,OAC5D,OAAOvF,KACX,GAuLT,SAAuBuJ,GAC1B,IACI,OAAOgH,QAAQhH,EAAQ0E,YAAYuC,aAAa,CAAEC,KAAM,SAC3D,CACD,MACI,OAAO,CACV,CACL,CA9LoBC,CAAcvD,EAAUxD,UAAW,CACnCwD,EAAUkB,WAAalB,EAAUxD,SAAS6G,aAAa,CAAEC,KAAM,SAC/D,MAAME,EAAa1D,SAAS/E,cAAc,SAC1CyI,EAAW3K,YAAc,GACzBmH,EAAU8B,iBAAmB0B,EAC7BxD,EAAUkB,WAAWC,YAAYqC,GACjC,MAAMnE,EAAkB,GACxB,IAAK,MAAMb,KAASwB,EAAU9J,aAC1BsI,EAAM3C,SAASmE,GACfX,EAAgBzI,KAAK4H,GAEzB,IAAK,MAAMA,KAASwB,EAAU7J,YAC1BqI,EAAM3C,SAASmE,GACfwD,EAAW3K,aAAe,KAAO2F,EAAMzC,WAE3C,MAAM0H,EAAqBpE,EAAgBL,KAAK,QAGhD,OAFIyE,EAAmBrL,OAAS,IAC5BoL,EAAW3K,aAAe,gBAAgB4K,QACvC5Q,IACV,CACD,MAAM,IAAI2C,MAAM,kDAAkDwK,EAAU1B,iBAC/E,EACDoF,mBACI,MAAM1D,EAAYnN,KAAK0G,QACvB,IAAK,MAAMoK,KAAa3D,EAAUjK,WAC9B4N,EAAU9H,SAASmE,GAEvB,OAAOnN,IACV,EACD+Q,kBACI,MAAM5D,EAAYnN,KAAK0G,QACvB,IAAK,MAAML,KAAY8G,EAAU/J,UAC7BiD,EAAS2C,SAASmE,GAEtB,OAAOnN,IACV,GAELA,KAAK+G,OAAS,CACVL,QAAS1G,KACTiK,aAKI,OAJAjK,KACKgR,mBACA7C,iBACA8C,kBACEjR,IACV,EACDgR,mBACI,MAAM7D,EAAYnN,KAAK0G,QACvB,IAAK,MAAMvC,KAAagJ,EAAUnK,WAC9BmB,EAAU4C,OAAO6B,aAAazE,EAAUhE,OAE5C,OAAOH,IACV,EACDmO,iBACI,MAAMhB,EAAYnN,KAAK0G,QACvB,IAAK,MAAMhC,KAAayI,EAAUpK,WAC9B2B,EAAUqC,OAAOkD,aAErB,OAAOjK,IACV,EACDkR,eACI,MAAM/D,EAAYnN,KAAK0G,QACvB,IAAK,MAAMiF,KAASwB,EAAU9J,cAG9B,OAAOrD,IACV,EACDiR,kBACI,MAAM9D,EAAYnN,KAAK0G,QACvB,IAAK,MAAML,KAAY8G,EAAU/J,UAC7BiD,EAASU,OAAOC,iBAEpB,OAAOhH,IACV,GAELA,KAAKqI,OAAS,CACV3B,QAAS1G,KACToN,gBAAgBJ,GACZ,MAAMG,EAAYnN,KAAK0G,QACjByK,EAAchE,EAAUnK,WAAWoO,QAAQpE,GAIjD,OAHoB,GAAhBmE,GACAhE,EAAUnK,WAAW+F,OAAOoI,EAAa,GAC7ChE,EAAUxD,SAASyD,gBAAgBJ,EAAYvB,MACxCzL,IACV,EACDsI,aACI,MAAM6E,EAAYnN,KAAK0G,QACjB/B,EAAWwI,EAAUxI,SACrB4J,EAAc5J,EAAS5B,WAAWyL,WAAU9J,GAAaxD,OAAOuN,GAAG/J,EAAWyI,KAMpF,OALoB,GAAhBoB,GACA9L,EAAW,oEACfkC,EAAS5B,WAAWgG,OAAOwF,EAAa,GACxCpB,EAAUpK,WAAWmB,SAAQQ,GAAaA,EAAU2D,OAAOC,eAC3D6E,EAAUxD,SAASmF,SACZ9O,IACV,GAELA,KAAKyL,KAAOA,EACZvK,OAAOmQ,OAAOrR,KAAMqF,EACvB,CACD2D,SAASvF,GACL,MAAMiL,EAAa,IAAM1O,KAAK8M,QACzBC,WAAWvH,EAAUxF,KAAK2J,WAC1BkH,mBACAP,eACAnB,mBACAjB,iBACAyB,uBACAE,mBACL,GAAa,OAATpM,EACAiL,SAEC,GAAIjL,aAAgBwF,YACrByF,IACAjL,EAAK6K,YAAYtO,KAAK2J,eAErB,GAAIlG,aAAgBlC,UACrBvB,KAAK2E,SAAWlB,EAAMiL,KACrBjL,EAAK4K,YAAc5K,EAAKkG,UAAU2E,YAAYtO,KAAK2J,cAEnD,MAAIlG,aAAgB9B,YAMrB,MAAM,IAAIgB,MAAM,sCAAsC3C,KAAKyL,0EAL3DzL,KAAK2E,SAAWlB,EAAMiL,IACtBjL,EAAKkG,SAAS2E,YAAYtO,KAAK2J,UAC/BlG,EAAKsD,OAAOqH,YAAYpO,KAI3B,CACD,OAAOA,KAAKkJ,UACf,CACDrC,iBAAiBD,GACb,MAAMkK,EAAY9Q,KAAKkD,YAAYoO,MAAKR,GAAalK,KAAQkK,EAAUjH,KACvE,OAAOiH,IAAYjH,GAAgBjD,IAAS5G,KAAK2E,UAAUkC,iBAAiBD,EAC/E,CACDE,iBAAiBF,EAAMzG,GACnB,MAAM2Q,EAAY9Q,KAAKkD,YAAYoO,MAAKR,GAAalK,KAAQkK,EAAUjH,KACvE,GAAIiH,EAGA,OAFAA,EAAUjH,GAAgBjD,GAAQzG,EAClCH,KAAK+G,OAAOkD,aACL9J,EAEX,MAAMyN,EAAS5N,KAAK2E,UAAUmC,iBAAiBF,EAAMzG,GACrD,OAAOyN,CACV,CACD1E,SAASC,EAAS,GACd,MAOMoI,EAAqBhM,GAAWA,EAAS,EAAI,KAAO,KAAKqH,OAAOzD,EAAS,GAAK,GAE9EqI,EATY,CACd,OAAQ,OAAQ,KAChB,MAAO,QAAS,KAChB,MAAO,QAAS,OAChB,OAAQ,QAAS,SACjB,QAAS,OAIyBC,SAASzR,KAAKyL,MAAQ,IAAM,GAC5DiG,EAAc1R,KAAK+C,WAAWyB,KAAIlD,GAAKA,EAAE4H,SAASC,EAAS,KAAIgD,KAAK,KAAO,KAAKS,OAAOzD,EAAS,IAChGwI,EAAY3R,KAAKgD,WAAWwB,KAAIlD,GAAK,GAAGA,EAAEmK,WAAWxF,EAAU3E,EAAEnB,YAAWgM,KAAK,KACjFyF,EAAgB5R,KAAKoD,UAAUoB,KAAIlD,GAAKA,EAAE4H,SAASC,EAAS,KAAIgD,KAAK,KAAO,KAAKS,OAAOzD,IACxF0I,EAAiB,IAAI7R,KAAKyL,OAAOkG,EAAUpM,OAAS,IAAM,KAAKoM,IAAYH,KAC3EM,EAAiB,GAAGP,EAAkBG,EAAYnM,QAAUqM,EAAcrM,QAC5EmM,GACCE,EAAcrM,OAASgM,EAAkBG,EAAYnM,QAAUqM,EAAgB,KAR3DrM,EASLmM,EAAYnM,QAAUqM,EAAcrM,OATpBA,EAAS,EAAI,KAAO,KAAKqH,OAAOzD,GAAU,QASVnJ,KAAKyL,QATjD,IAAClG,EAWzB,MADmB,GAAGsM,IAAkBL,EAAuC,GAAjBM,GAEjE,EAWE,SAASC,EAAOC,GACnB,OAAOA,GAAa,IACxB,CAXAzQ,UAAU0Q,OAAS,CAACvL,EAAS+E,EAAM3I,IACxB,IAAIvB,UAAUkK,EAAM,IAAK3I,EAAO6G,SAAUjD,IAuB9C,MAAMgF,EAAgBwG,GAAQA,EAAInR,QAAQ,0BAA0B,CAACoR,EAAGC,KAASA,EAAM,IAAM,IAAMD,EAAEE,gBAiC5G,SAAS9K,EAAKC,EAAOC,GACjB,MAAM6K,EA6GN,SAAwB9K,EAAOC,GAC3B,OAAItG,EAAYqG,IAAUrG,EAAYsG,GAtC1C,SAA2BD,EAAOC,GAC9B,MAAM8K,EAAoB/K,EAAMzE,WAC1ByP,EAAqB/K,EAAM1E,WAC3B0P,EAAsBjL,EAAMxE,WAC5B0P,EAAuBjL,EAAMzE,WAC7BsE,EAAQ,CACVqL,KAAMzR,OAAO0R,eAAepL,GAAOpB,YACnCoB,MAAOA,EACPC,MAAOA,EACP3F,CAACA,GAAU,GACXE,CAACA,GAAU,GACXC,CAACA,GAAU,GACXC,CAACA,GAAY,GACbsG,WAAY,IAEhB,IAAK,IAAIhF,EAAI,EAAGA,EAAIqP,KAAKC,IAAIP,EAAkBhN,OAAQiN,EAAmBjN,QAAS/B,IAAK,CACpF,MAAMuP,EAAiBR,EAAkB/O,GACnCwP,EAAkBR,EAAmBhP,QACpByP,IAAnBF,EACAzL,EAAMxF,GAASiC,KAAK,CAAC,aAAcP,EAAI,UACdyP,IAApBD,EACL1L,EAAMrF,GAAS8B,KAAK,CAAC,aAAcP,EAAI,KAEvC8D,EAAMkB,WAAWzE,KAAKwD,EAAKwL,EAAgBC,GAClD,CACD,IAAK,IAAIxP,EAAI,EAAGA,EAAIqP,KAAKC,IAAIL,EAAoBlN,OAAQmN,EAAqBnN,QAAS/B,IAAK,CACxF,MAAM0P,EAAqBT,EAAoBjP,GACzC2P,EAAsBT,EAAqBlP,QACtByP,IAAvBC,EACA5L,EAAMxF,GAASiC,KAAK,CAAC,aAAcP,EAAI,UACVyP,IAAxBE,EACL7L,EAAMrF,GAAS8B,KAAK,CAAC,aAAcP,EAAI,KAEvC8D,EAAMkB,WAAWzE,KAAKwD,EAAK2L,EAAoBC,GACtD,CACD,OAAO7L,CACV,CAGc8L,CAAkB5L,EAAOC,GAChC/F,EAAa8F,IAAU9F,EAAa+F,GAjE5C,SAA4BD,EAAOC,GAC/B,MAAM4L,EAAoB7L,EAAMzE,WAC1BuQ,EAAqB7L,EAAM1E,WAC3BuE,EAAQ,CACVqL,KAAMzR,OAAO0R,eAAepL,GAAOpB,YACnCoB,MAAOA,EACPC,MAAOA,EACP3F,CAACA,GAAU,GACXE,CAACA,GAAU,GACXC,CAACA,GAAU,GACXC,CAACA,GAAY,GACbsG,WAAY,IAEhB,IAAK,IAAIhF,EAAI,EAAGA,EAAIqP,KAAKC,IAAIO,EAAkB9N,OAAQ+N,EAAmB/N,QAAS/B,IAAK,CACpF,MAAM+P,EAAiBF,EAAkB7P,GACnCgQ,EAAkBF,EAAmB9P,QACpByP,IAAnBM,EACAjM,EAAMxF,GAASiC,KAAK,CAAC,aAAcyP,SACVP,IAApBO,EACLlM,EAAMrF,GAAS8B,KAAK,CAAC,aAAcwP,IAEnCjM,EAAMkB,WAAWzE,KAAKwD,EAAKgM,EAAgBC,GAClD,CACD,OAAOlM,CACV,CA0CcmM,CAAmBjM,EAAOC,GACjCjG,EAAcgG,IAAUhG,EAAciG,GA/E9C,SAA6BiM,EAAcC,GACvC,MAQMpM,EAAOqM,EARK,CACdxO,OAAQsO,EACRrO,MAAO,CAAC,CAAC,QAAS,CAAC,WAEL,CACdD,OAAQuO,EACRtO,MAAO,CAAC,CAAC,QAAS,CAAC,YAGvB,OAAOkC,CACV,CAqEcsM,CAAoBrM,EAAOC,GAClC7F,EAAS4F,IAAU5F,EAAS6F,GA7FpC,SAAwBD,EAAOC,GAC3B,MAAMqM,EAAY,CACd1O,OAAQoC,EACRnC,MAAO,CAAC,CAAC,UAEP0O,EAAY,CACd3O,OAAQqC,EACRpC,MAAO,CAAC,CAAC,UAEPkC,EAAOqM,EAAaE,EAAWC,GACrC,OAAOxM,CACV,CAmFcyM,CAAexM,EAAOC,GAGrC,SAA+BD,EAAOC,GAClC,MAAMH,EAAQ,CACVqL,KAAMzR,OAAO0R,eAAepL,GAAOpB,YACnCoB,MAAOA,EACPC,MAAOA,EACP3F,CAACA,GAAU,GACXE,CAACA,GAAU,GACXC,CAACA,GAAU,GACXC,CAACA,GAAY,GACbsG,WAAY,KAETyL,EAASC,GAAW,CAAC1O,EAAUgC,GAAQhC,EAAUiC,IACpDwM,GACA3M,EAAMxF,GAASiC,KAAK,CAAC,SACrBmQ,GACA5M,EAAMrF,GAAS8B,KAAK,CAAC,SACzB,GAAIkQ,GAAWC,EACX,OAAO5M,EACX,MAAM6M,EAAe3M,EAAM7C,SAAS5B,WAAWyL,WAAUlN,GAAKJ,OAAOuN,GAAGjH,EAAOlG,KAE/E,OADAgG,EAAMtF,GAAS+B,KAAK,CAAC,aAAcoQ,EAAe,KAC3C7M,CACV,CAvBU8M,CAAsB5M,EAAOC,EACvC,CAvHsB4M,CAAe7M,EAAOC,GAC7C,OAAO6K,EACP,SAASsB,EAAaE,EAAWC,GAC7B,MAAMxM,EAAO,CACToL,KAAMzR,OAAO0R,eAAekB,EAAU1O,QAAQgB,YAC9CoB,MAAOsM,EAAU1O,OACjBqC,MAAOsM,EAAU3O,OACjBtD,CAACA,GAAU,GACXE,CAACA,GAAU,GACXC,CAACA,GAAU,GACXC,CAACA,GAAY,GACbsG,WAAY,IAEV8L,EAAeR,EAAUzO,MAAMsF,QAAO/D,GAAQpB,EAAUL,EAAiB4O,EAAU3O,OAAQwB,MACjGW,EAAKtF,GAAWqS,EAChB,MAAMC,EAAeR,EAAU1O,MAAMsF,QAAO/D,GAAQpB,EAAUL,EAAiB2O,EAAU1O,OAAQwB,MACjGW,EAAKzF,GAAWyS,EAChB,MAAMC,EAAeV,EAAUzO,MAAMsF,QAAO/D,GAAQzB,EAAiB4O,EAAU3O,OAAQwB,KAAUzB,EAAiB2O,EAAU1O,OAAQwB,KACpIW,EAAKvF,GAAWwS,EAChB,MAAMC,EAAiBX,EAAUzO,MAAMsF,QAAO/D,GAAQzB,EAAiB4O,EAAU3O,OAAQwB,KAAUzB,EAAiB2O,EAAU1O,OAAQwB,KAEtI,OADAW,EAAKrF,GAAauS,EACXlN,CACV,CAwHL,CACO,MAAMmN,EAAoB,CAC7B,IACA,UACA,UACA,QACA,QACA,IACA,OACA,MACA,KACA,SACA,SACA,UACA,OACA,OACA,MACA,WACA,UACA,OACA,WACA,KACA,MACA,UACA,MACA,SACA,MACA,KACA,KACA,KACA,QACA,WACA,SACA,aACA,SACA,OACA,KACA,KACA,KACA,KACA,KACA,KACA,OACA,SACA,SACA,KACA,OACA,IACA,MACA,QACA,MACA,MACA,QACA,SACA,KACA,OACA,OACA,MACA,OACA,OACA,QACA,MACA,WACA,SACA,KACA,WACA,SACA,SACA,IACA,QACA,MACA,WACA,SACA,IACA,OACA,IACA,UACA,QACA,OACA,SACA,KACA,IACA,MACA,QACA,MACA,OACA,OACA,MACA,aACA,OACA,SACA,OACA,OACA,UACA,KACA,KACA,KACA,MACA,OACA,SACA,SACA,OACA,SACA,SACA,QACA,MACA,UACA,MACA,QACA,QACA,KACA,WACA,WACA,QACA,KACA,QACA,OACA,QACA,KACA,QACA,MC3zCJ,IAAIC,EAAqB3U,MAAQA,KAAK2U,mBAAsB,SAAUtU,EAAGoL,EAAMmJ,GAE3E,MADoB,iBAATnJ,IAAmBA,EAAOA,EAAKoJ,YAAc,IAAIC,OAAOrJ,EAAKoJ,YAAa,KAAO,IACrF3T,OAAO6T,eAAe1U,EAAG,OAAQ,CAAE2U,cAAc,EAAM7U,MAAOyU,EAAS,GAAGE,OAAOF,EAAQ,IAAKnJ,GAAQA,GACjH,EAGA,MAAMwJ,EAAiBlT,OAAO,kBA6BjBmT,EAAU,IAAIzO,MAAM,GAAI,CACjC9F,IAAG,CAACgG,EAAQC,IACW,iBAARA,EACAD,EAAOC,GACN,aAARA,EACOuO,EACJ,IAAIrS,IAAU,IAAIvB,UAAUqF,EAAM/D,EAASC;;;;;;;;;;;;;;;;;;;;;;;;;;;;GAG1D,SAASqS,EAAUC,GACfV,EACKxQ,SAAQqF,IAAY6L,GAAeC,YAAY9L,GAAW2L,EAAQ3L,IAC3E;;;;GAKA,MAAM7D,EAAO,IAAIe,OAwFjB,SAAe6O,KAASC,GACpB,IAAIC,EAAQF,E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"}