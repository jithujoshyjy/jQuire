if("undefined"==typeof window&&"undefined"===window.document)throw new Error("Jquire cannot run outside of a browser environment.");let jquery=(...a)=>{throw new ReferenceError("Jquery cannot be found.")};void 0!==window.$&&(jquery=window.$);let newElements=new Array,elementStack=new Array,currentElement=null,currentNode=null,jquire={add(b){for(let c of Object.keys(b)){let a=Object.create(null);a.name=c,a.type="partial",a.parent=null,a.create=function(a=null){let n=document.createDocumentFragment(),d={type:"custom",name:c,body:n,data:a.data,parent:a.parent},f=arrowFnToRegularFn(b[c]).bind(d);if("function"!=typeof f)throw new TypeError(`InvalidComponentConstructor: Expected a function instead got ${typeof f}`);elementStack.push(d),currentElement=currentNode=d,f();let o=d.slots||[];for(let e of o){let k=e.body.getAttribute("name");if(k){let g=[];for(let h of a.body.childNodes)h.getAttribute?.("slot")===k&&(g.push(h.cloneNode(!0)),h.remove());if(g.length){let l=document.createDocumentFragment();l.append(...g),e.parent?.body.replaceChild(l,e.body)}}else{let i=[];for(let j of a.body.childNodes)j.getAttribute?.("slot")||(i.push(j.cloneNode(!0)),j.remove());if(i.length){let m=document.createDocumentFragment();m.append(...i),e.parent?.body.replaceChild(m,e.body)}}}return a&&d.body.appendChild(a.body),elementStack.pop()},newElements.push(a)}},text(){let b=elementStack.slice(-1)?.[0],a=(c=null,...d)=>{let e=[c[0]];d.forEach((a,b)=>e.push(a,c[b+1]));let a=document.createTextNode(e.join(""));return currentNode=a,b&&b.body.append(a),a};return new Proxy(a,{get(d,c,e){let a=document.createTextNode(c);return b&&b.body.append(a),currentNode=a,a}})},render(){let b=document.createDocumentFragment(),a={type:"custom",name:"render",body:b,data:{},parent:null},c=currentElement;return currentElement=currentNode=a,elementStack.push(a),new Proxy(a,{get(a,b,d){if(b in a)return a[b];if(currentElement=currentNode=c??null,!("tag"in a.data))throw new Error("NoRenderTarget: The required 'tag' attribute is missing.");if(!(a.data.tag instanceof HTMLElement))throw new TypeError(`InvalidRenderTarget: Expected an HTML element as the value of the 'tag' attribute, instead got '${typeof a.data.tag}'.`);return elementStack.pop(),a.data.tag.append(a.body),a.body}})}},_self=new Proxy(function(a=this){return a.data},{get:(b,a,c)=>currentElement.data[a]}),_parent=new Proxy(function(a=this){return a.parent?.data??{}},{get:(b,a,c)=>currentElement.parent?.data?.[a]}),_parents=new Proxy(function(b=this){let a=()=>b;return new Proxy(a(),{get(a,b,d){let c=(a,b)=>void 0!==a.data[b]?a.data[b]:null!==a.parent?c(a.parent,b):void 0;return c(a,b)}})},{get(c,a,d){let b=(a,c)=>void 0!==a.data[c]?a.data[c]:null!==a.parent?b(a.parent,c):void 0;return b(currentElement,a)}}),query=(...a)=>jquery(...a),$=new Proxy(query,{get:handleElmProxyPropAccess}),_=new Proxy({},{set:handleAttrProxyPropAssign,get:handleAttrProxyPropAccess});function createElement(elmName){if(/^[a-z]/.test(elmName))return createJQHTMLElement(elmName);if(/^[A-Z]/.test(elmName))return createJQCustomElement(elmName);throw new Error(`InvalidElement: '${elmName}' - is not a valid HTML Element or a custom element.`)}function createJQHTMLElement(elmName){let parentElm=elementStack.slice(-1)?.[0],elm={type:"html",name:elmName,body:document.createElement(elmName),data:{},parent:parentElm??null};if(elm.body instanceof HTMLUnknownElement)throw new Error(`InvalidHTMLElement: '${elmName}' is not a valid HTML element.`);return elementStack.push(elm),currentElement=currentNode=elm,new Proxy(elm,{get(b,a,d){if(a in b)return b[a];let c=elm.body.childNodes?.length==0&&0==Object.keys(elm.data).length&&0==elm.body.attributes.length;return c&&elm.body.append(a),parentElm&&parentElm.body.append(elm.body),currentElement=currentNode=parentElm??null,parentElm&&"custom"==parentElm.type&&"slot"==elmName&&(parentElm.slots=[...parentElm.slots||[],elm]),elm.data=createDataAttrProxy(elm),elementStack.pop()}})}function createJQCustomElement(elmName){let newElementConstructor=newElements.find(a=>a.name==elmName);if(!newElementConstructor)throw new Error(`NotDefined: Custom element - '${elmName}' is not defined.`);let parentElm=elementStack.slice(-1)?.[0],newElement={type:"custom",name:elmName,body:new DocumentFragment,data:{},parent:parentElm??null};return elementStack.push(newElement),currentElement=currentNode=newElement,new Proxy(newElement,{get(b,a,d){if(a in b)return b[a];newElement=newElementConstructor.create(newElement);let c=newElement.body.childNodes?.length==0&&0==Object.keys(newElement.data).length;return c&&newElement.body.append(a),parentElm&&parentElm.body.append(newElement.body),currentElement=currentNode=parentElm??null,newElement.data=createDataAttrProxy(newElement),elementStack.pop()}})}function createAttribute(attr,elm,defVal=null){let attrObj=document.createAttribute(attr);return"html"==elm.type?attr.startsWith("on")?createEventHandler(attr,elm,defVal):createHTMLAttribute({attrName:attr,attrObj},elm,defVal??""):["custom","partial"].includes(elm.type)?createDataAttribute(attr,elm,defVal):void 0}function createHTMLAttribute({attrName,attrObj},elm,defVal=""){if(/[^a-z]/g.test(attrName)){if(/[A-Z\-\_]/g.test(attrName))return createDataAttribute(attrName,elm,defVal);throw new Error(`InvalidAttribute: The attribute '${attrName}' is not a valid html attribute.`)}elm.body.setAttributeNode(attrObj),elm.body.setAttribute(attrName,defVal)}function createDataAttribute(attr,elm,defVal=null){let attrCamelCase=toCamelCase(attr);if("html"==elm.type){let isPrimitive=typeof["string","boolean","number","bigint"].includes(defVal),isNullish=[void 0,null].includes(defVal);(isNullish||isPrimitive)&&(elm.body.dataset[attrCamelCase]=defVal.toString()),elm.data[attrCamelCase]="function"==typeof defVal?arrowFnToRegularFn(defVal).bind(elm):defVal}else["custom","partial"].includes(elm.type)&&(elm.data[attrCamelCase]="function"==typeof defVal?arrowFnToRegularFn(defVal).bind(elm):defVal);return elm.data}function createEventHandler(attr,elm,callback){let event=attr.slice(2);if("function"!=typeof callback)throw new TypeError(`Expeted a function as event handler callback but got '${typeof callback}' instead.`);let _callback=arrowFnToRegularFn(callback).bind(elm);elm.body.addEventListener(event,_callback)}function arrowFnToRegularFn(callback){let _callback=callback,stringifiedCallback=callback.toString(),isArrowFn=!stringifiedCallback.trim().startsWith("function");if(isArrowFn){let isParamsInParantheses=stringifiedCallback.trim().startsWith("("),[fnParams,...fnBody]=stringifiedCallback.split("=>"),hasBlockFnBody=fnBody[0].trim().startsWith("{");_callback=eval("(function"+(isParamsInParantheses?"":"(")+fnParams+(isParamsInParantheses?"":")")+(hasBlockFnBody?"":"{ return")+fnBody.join("=>")+(hasBlockFnBody?"":"}")+")")}return _callback}function handleElmProxyPropAccess(target,prop,reciever){return prop in jquire?"new"==prop?jquire.new():"text"==prop?jquire.text():"render"==prop?jquire.render():"function"==typeof jquire[prop]?jquire[prop]:void 0:createElement(prop)}function handleAttrProxyPropAccess(target,prop,reciever){if("prototype"==prop)return Object.getPrototypeOf(target);if(!currentElement)throw new Error(`OutOfScopeAttribute: Attribute '${prop}' cannot be accessed outside an element`);return currentElement.data[prop]}function handleAttrProxyPropAssign(target,prop,value){if(!currentElement)throw new Error(`OutOfScopeAttribute: Attribute '${prop}' cannot be accessed outside an element`);return createAttribute(prop,currentElement,value)||!0}function createDataAttrProxy(elm){return new Proxy(elm.data,{set(b,c,a){if(!c in b)throw new ReferenceError(`Data attribute '${c}' not defined on the element '${elm.name}'`);{let d=toCamelCase(c);if("html"==elm.type){let e=typeof["string","boolean","number","bigint"].includes(a),f=[void 0,null].includes(a);(f||e)&&(elm.body.dataset[d]=a.toString()),b[d]="function"==typeof a?arrowFnToRegularFn(a).bind(elm):a}else["custom","partial"].includes(elm.type)&&(b[d]="function"==typeof a?arrowFnToRegularFn(a).bind(elm):a);return elm.data}}})}function toKebabCase(str){let _str=str;return str.includes("_")&&!str.includes("-")?_str=str.replace(/_/g,"-"):str.includes("-")||/[A-Z]/g.test(str)||(_str=str.replace(/^./,a=>a.toLowerCase()).replace(/[A-Z]/g,a=>"-"+a.toLowerCase())),_str.toLowerCase()}function toCamelCase(str){let _str=str;return/[A-Z]/g.test(str)?_str=str.toLowerCase():str.includes("-")?_str=str.split("-").map(a=>a.toLowerCase().replace(/^./,a=>a.toUpperCase())).join("").replace(/^./,a=>a.toLowerCase()):str.includes("_")&&(_str=str.split("_").map(a=>a.toLowerCase().replace(/^./,a=>a.toUpperCase())).join("").replace(/^./,a=>a.toLowerCase())),_str}_.prototype[Symbol.toPrimitive]=function(a){return""};export{$,_,_self,_parent,_parents}